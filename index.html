<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Hayreal">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-Rust_Advanced" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/10/14/Rust_Advanced/" class="article-date">
  <time class="dt-published" datetime="2024-10-14T09:13:45.915Z" itemprop="datePublished">2024-10-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Rust进阶"><a href="#Rust进阶" class="headerlink" title="Rust进阶"></a>Rust进阶</h1><h1 id="Rust智能指针概述和BOX指针"><a href="#Rust智能指针概述和BOX指针" class="headerlink" title="Rust智能指针概述和BOX指针"></a>Rust智能指针概述和BOX指针</h1><p><em><strong>智能指针是一类数据结构，不仅包含一个指针，还附带一些额外的元数据和功能。与普通指针不同，智能指针在Rust中实现了Deref和drop两个trait，这使得他们可以像指针一样解引用并在离开作用域时自动清理资源</strong></em></p>
<ul>
<li>为什么存在智能指针？<ul>
<li>资源管理：自动管理资源的的分配和释放，避免内存泄漏</li>
<li>所有权的与借用：Rust的所有权系统通过智能指针来确保内存安全，避免数据竞争和悬垂指针</li>
<li>复杂数据结构：通过智能指针可以构建复杂的数据结构，如递归结构，共享数据等</li>
</ul>
</li>
<li><h2 id="智能指针的特性-Deref-Trait-实现了Deref-trait的类型可以像常规引用一样使用运算符解引用-例如Box实现了Deref，所以可以通过解引用获取其内部数据-Drop-Trait-实现了Drop-trait的类型在离开作用域时会自动调用其drop方法，用于释放资源-例如：Box在超出作用域时会自动释放堆内存"><a href="#智能指针的特性-Deref-Trait-实现了Deref-trait的类型可以像常规引用一样使用运算符解引用-例如Box实现了Deref，所以可以通过解引用获取其内部数据-Drop-Trait-实现了Drop-trait的类型在离开作用域时会自动调用其drop方法，用于释放资源-例如：Box在超出作用域时会自动释放堆内存" class="headerlink" title="智能指针的特性- Deref Trait  - 实现了Deref trait的类型可以像常规引用一样使用运算符解引用  - 例如Box实现了Deref，所以可以通过解引用获取其内部数据- Drop Trait  - 实现了Drop trait的类型在离开作用域时会自动调用其drop方法，用于释放资源  - 例如：Box在超出作用域时会自动释放堆内存"></a>智能指针的特性<br>- Deref Trait<br>  - 实现了Deref trait的类型可以像常规引用一样使用<em>运算符解引用<br>  - 例如Box<T>实现了Deref，所以可以通过</em>解引用获取其内部数据<br>- Drop Trait<br>  - 实现了Drop trait的类型在离开作用域时会自动调用其drop方法，用于释放资源<br>  - 例如：Box<T>在超出作用域时会自动释放堆内存</h2></li>
</ul>
<h2 id="Box"><a href="#Box" class="headerlink" title="Box"></a>Box<T></h2><ul>
<li>基本概念<ul>
<li>Box<T>将类型T的值分配在堆上，而不是栈上。</li>
<li>当Box被销毁时，堆上的数据也会被销毁</li>
</ul>
</li>
<li>Box的底层实现<ul>
<li>底层原理：Box<T>实际上是一个智能指针，内部包含了一个指向堆上分配内存的裸指针。当Box<T>被销毁时,其内部的Drop trait会被调用，释放堆上的内存</li>
<li>内存分配</li>
<li>Rust使用系统的全局分配器（malloc 和 free）来管理堆内存。Box::new()分配内存，Drop释放内存</li>
<li>安全性：Rust的所有权系统确保Box<T>的内存安全。所有权转移时，堆内存的生命周期也随之变化</li>
</ul>
</li>
<li>Box的使用场景<ul>
<li>堆分配：Box最常见的用途是将数据分配在堆上，而不是栈上。这在处理较大的数据结构或者数据结构大小在编译器不确定时尤为重要</li>
<li>动态大小类型(DST)：Box允许处理动态大小类型，如str和[T]<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">s</span>: <span class="type">Box</span>&lt;<span class="type">str</span>&gt; = <span class="string">&quot;hello&quot;</span>.<span class="title function_ invoke__">into</span>();</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, s);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">arr</span>: <span class="type">Box</span>&lt;[<span class="type">i32</span>]&gt; = <span class="built_in">vec!</span>[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].<span class="title function_ invoke__">into_boxed_slice</span>();</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, arr);</span><br></pre></td></tr></table></figure></li>
<li>递归数据结构：递归数据结构需要使用指针类型来引用自身，而Box提供了这一功能。<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> List::&#123;Cons,Nil&#125;;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>()&#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">list</span> = <span class="title function_ invoke__">Cons</span>(</span><br><span class="line">        <span class="number">1</span>, </span><br><span class="line">        <span class="type">Box</span>::<span class="title function_ invoke__">new</span>(<span class="title function_ invoke__">Cons</span>(<span class="number">2</span>,<span class="type">Box</span>::<span class="title function_ invoke__">new</span>(<span class="title function_ invoke__">Cons</span>(<span class="number">3</span>,<span class="type">Box</span>::<span class="title function_ invoke__">new</span>(Nil)))))</span><br><span class="line">    );</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>,list);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">List</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">Cons</span>(<span class="type">i32</span>,<span class="type">Box</span>&lt;List&gt;),</span><br><span class="line">    Nil</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>类型擦除：Box<dyn Trait>用于类型擦除，允许在运行时决定类型。<br><em><strong>dyn关键字用于指定动态分发的类型，它允许在运行时决定具体类型。在Rust中，dyn关键字用于实现动态分发的trait对象</strong></em><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用Box&lt;dyn Trait&gt;相当于实现了trait的多态</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>()&#123;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">animals</span>:<span class="type">Vec</span>&lt;<span class="type">Box</span>&lt;<span class="keyword">dyn</span> Animal&gt;&gt; = <span class="built_in">vec!</span>[<span class="type">Box</span>::<span class="title function_ invoke__">new</span>(Dog),<span class="type">Box</span>::<span class="title function_ invoke__">new</span>(Cat)];</span><br><span class="line"><span class="keyword">for</span> <span class="variable">animals</span> <span class="keyword">in</span> animals.<span class="title function_ invoke__">iter</span>() &#123;</span><br><span class="line">    animals.<span class="title function_ invoke__">speak</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">trait</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">speak</span>(&amp;<span class="keyword">self</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Dog</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Cat</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Animal</span> <span class="keyword">for</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">speak</span>(&amp;<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Woof!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Animal</span> <span class="keyword">for</span> <span class="title class_">Cat</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">speak</span>(&amp;<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Meow!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>内存管理和性能优化：通过使用Box，可以控制内存的分配和释放，从而优化性能和内存使用。例如，将大型数据结构放在堆上而不是栈上，可以减少栈的使用量，从而避免栈溢出。<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//thread &#x27;main&#x27; has overflowed its stack</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">origin_arr</span> = [<span class="number">0u8</span>;<span class="number">1_000_000</span>];</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>,origin_arr[<span class="number">999_999</span>]);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">large_arr</span> = <span class="type">Box</span>::<span class="title function_ invoke__">new</span>([<span class="number">0u8</span>;<span class="number">1_000_000</span>]);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>,large_arr[<span class="number">999_999</span>]);</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>Box的优缺点<ul>
<li>优点<ul>
<li>提供堆内存分配，支持复杂数据结构</li>
<li>与Rust的所有权系统完美集成，确保内存安全</li>
<li>动态分配对象，实现类型擦除</li>
</ul>
</li>
<li>缺点<ul>
<li>需要堆内存的分配和释放，可能带来性能开销</li>
<li>不适合需要频繁分配和释放的场景</li>
</ul>
</li>
</ul>
</li>
<li>Drop、Deref和DerefMut<ul>
<li><p>Drop Trait</p>
<ul>
<li>Drop trait定义了当一个值离开作用域时应该执行的操作</li>
<li>例如：Box<T>在超出作用域时会自动调用Drop trait，释放堆上的内存</li>
<li>通常用于释放资源（例如内存，文件句柄，网络连接等）<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>()&#123;</span><br><span class="line">    <span class="title function_ invoke__">foo</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">foo</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">resource</span> = Resource&#123;name:<span class="string">&quot;My Resource&quot;</span>.<span class="title function_ invoke__">to_string</span>()&#125;;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Using &#123;&#125;&quot;</span>, resource.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Resource</span>&#123;</span><br><span class="line">    name:<span class="type">String</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Drop</span> <span class="keyword">for</span> <span class="title class_">Resource</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">drop</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Dropping &#123;&#125;&quot;</span>, <span class="keyword">self</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>Deref Trait</p>
<ul>
<li>Deref trait 用于重载解引用运算符(*)，允许自定义指针类型的解引用行为</li>
<li>定义了一个deref方法，返回一个指向内部数据的指针<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::ops::Deref;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>()&#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">y</span> = MyBox::<span class="title function_ invoke__">new</span>(x);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;x = &#123;&#125;&quot;</span>,x);</span><br><span class="line">    <span class="comment">// 使用*y解引用时候会自动调用deref方法</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;y = &#123;&#125;&quot;</span>,*y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MyBox</span>&lt;T&gt;(T);</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> &lt;T&gt; MyBox&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">new</span>(x: T) <span class="punctuation">-&gt;</span> MyBox&lt;T&gt; &#123;</span><br><span class="line">        <span class="title function_ invoke__">MyBox</span>(x)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> &lt;T&gt; Deref <span class="keyword">for</span> <span class="title class_">MyBox</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">type</span> <span class="title class_">Target</span> = T;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">deref</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> &amp;<span class="keyword">Self</span>::Target &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Deref Called&quot;</span>);</span><br><span class="line">        &amp;<span class="keyword">self</span>.<span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>DerefMut Trait</p>
<ul>
<li>与Deref trait类似，用于重载解引用运算符（*），但允许对自定义类型进行可变解引用<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::ops::Deref;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>()&#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">y</span> = MyBox::<span class="title function_ invoke__">new</span>(<span class="number">6</span>);</span><br><span class="line">    *y = <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>,*y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MyBox</span>&lt;T&gt;(T);</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> &lt;T&gt; MyBox&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">new</span>(x: T) <span class="punctuation">-&gt;</span> MyBox&lt;T&gt; &#123;</span><br><span class="line">        <span class="title function_ invoke__">MyBox</span>(x)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> &lt;T&gt; Deref <span class="keyword">for</span> <span class="title class_">MyBox</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">type</span> <span class="title class_">Target</span> = T;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">deref</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> &amp;<span class="keyword">Self</span>::Target &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Deref Called&quot;</span>);</span><br><span class="line">        &amp;<span class="keyword">self</span>.<span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 实现了可变解引用之前必须实现Deref trait</span></span><br><span class="line"><span class="keyword">impl</span> &lt;T&gt; DerefMut <span class="keyword">for</span> <span class="title class_">MyBox</span>&lt;T&gt; &#123;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">deref_mut</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>) <span class="punctuation">-&gt;</span> &amp;<span class="keyword">mut</span> T &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;DerefMut Called&quot;</span>);</span><br><span class="line">    &amp;<span class="keyword">mut</span> <span class="keyword">self</span>.<span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>?size(Box源码中实现)</p>
<p><em><strong>在Rust中所有类型都有size，他们的大小是固定的，在编译期就已知。?size可以让struct拥有一个动态大小的类型</strong></em></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将固定大小的类型放入Box中</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">box_i32</span> = <span class="type">Box</span>::<span class="title function_ invoke__">new</span>(<span class="number">42</span>);</span><br><span class="line"><span class="comment">// 将动态大小的类型放入Box</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">boxed_str</span>:<span class="type">Box</span>&lt;<span class="type">str</span>&gt; = <span class="string">&quot;Hello&quot;</span>.<span class="title function_ invoke__">into</span>();</span><br><span class="line"><span class="keyword">let</span> <span class="variable">boxed_slice</span>:<span class="type">Box</span>&lt;[<span class="type">i32</span>]&gt; = <span class="built_in">vec!</span>[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>].<span class="title function_ invoke__">into_boxed_slice</span>();</span><br></pre></td></tr></table></figure>
<ul>
<li>为什么需要?size<ul>
<li>在处理一些切片类型时，他们在编译时大小是未知的，通过?size可以解决这个问题</li>
</ul>
</li>
</ul>
</li>
<li><p>课后习题</p>
<ol>
<li>创建一个大型数组并将其分配到堆上，然后测量和比较分配在堆上和栈上的性能差异。创建一个包含1_000_000个元素的数组，然后分别将其分配在堆和栈上。使用std::time::Instant来测量分配和访问时间</li>
<li>实现一个简单的文件系统模拟<br> <img src="/image_practice.png" alt="alt text"></li>
</ol>
</li>
<li><p>解答</p>
</li>
<li><p>1</p>
 <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">fn</span> <span class="title function_">main</span>()&#123;</span><br><span class="line">  <span class="title function_ invoke__">stack_get</span>(&amp;[<span class="number">0u8</span>;<span class="number">1_000_000</span>]);</span><br><span class="line">  <span class="title function_ invoke__">heap_get</span>(<span class="type">Box</span>::<span class="title function_ invoke__">new</span>([<span class="number">0u8</span>;<span class="number">1_000_000</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//13160700</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">stack_get</span>(arr: &amp;[<span class="type">u8</span>;<span class="number">1_000_000</span>])&#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">start</span> = Instant::<span class="title function_ invoke__">now</span>();</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">_</span> <span class="keyword">in</span> <span class="number">0</span>..<span class="number">1_000_000</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">a</span> = arr[<span class="number">999999</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">duration</span> = start.<span class="title function_ invoke__">elapsed</span>();</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Nanoseconds: &#123;&#125;&quot;</span>, duration.<span class="title function_ invoke__">as_nanos</span>());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 15866000</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">heap_get</span>(arr: <span class="type">Box</span>&lt;[<span class="type">u8</span>;<span class="number">1_000_000</span>]&gt;)&#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">start</span> = Instant::<span class="title function_ invoke__">now</span>();</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">_</span> <span class="keyword">in</span> <span class="number">0</span>..<span class="number">1_000_000</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">a</span> = arr[<span class="number">999999</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">duration</span> = start.<span class="title function_ invoke__">elapsed</span>();</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Nanoseconds: &#123;&#125;&quot;</span>, duration.<span class="title function_ invoke__">as_nanos</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>2</p>
</li>
</ul>
<pre><code class="rust">
</code></pre>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/10/14/Rust_Advanced/" data-id="cm2hxo6390000tca29ohr02qa" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Rust" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/09/03/Rust/" class="article-date">
  <time class="dt-published" datetime="2024-09-02T16:00:00.000Z" itemprop="datePublished">2024-09-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/09/03/Rust/">Rust基础</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="一、概要"><a href="#一、概要" class="headerlink" title="一、概要"></a>一、概要</h1><p>rust由Mozilla主导开发的通用编译型变成语言。设计准则为安全，并发，实用、支持函数式、并发式、过程式以及面向对象的编程风格</p>
<ul>
<li>aaa内存安全：不允许空指针和悬空指针。指针只能透过固定的初始化形态来建构，而所有这些形态都要求他们的输入已经分析过了。Rust有一个检查指针生命期间和指针冻结的系统，可以预防许多类型错误。</li>
<li>静态类型：编译器必须在编译器就知道所有变量类型，有的变量编译器会通过变量值推到出类型，有的需要自己指定类型。</li>
<li>并发编程：通过所有权和并发原语可以编写出高效的多线程程序。</li>
</ul>
<h2 id="1、Hello-world"><a href="#1、Hello-world" class="headerlink" title="1、Hello_world"></a>1、Hello_world</h2><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>()&#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rustc main.rs  <span class="comment">## 编译main.rs文件</span></span><br><span class="line">./main.rs <span class="comment">## 执行</span></span><br></pre></td></tr></table></figure>

<h2 id="2、cargo"><a href="#2、cargo" class="headerlink" title="2、cargo"></a>2、cargo</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo new project_name  <span class="comment">## 通过cargo创建项目</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cargo build <span class="comment">## 编译项目，在target目录下生成可执行文件</span></span><br><span class="line">cargo build --release <span class="comment">## 构建最终用户程序，优化执行速度，但是编译时间更长</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo run  <span class="comment">## 运行项目，执行main.rs文件。这个命令同时也会执行cargo build 命令。</span></span><br></pre></td></tr></table></figure>
<h1 id="二、变量"><a href="#二、变量" class="headerlink" title="二、变量"></a>二、变量</h1><h2 id="可变变量和不可变变量"><a href="#可变变量和不可变变量" class="headerlink" title="可变变量和不可变变量"></a>可变变量和不可变变量</h2><p>  1、<em><strong>Rust 的变量在默认情况下是不可变的。让我们编写的代码更安全，性能也更好。可以通过 mut 关键字让变量变为可变的</strong></em></p>
<p>  2、<em><strong>变量可变性如果变量 a 不可变，那么一旦为它绑定值，就不能再修改</strong></em></p>
<h2 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h2><p><em><strong>Rust使用const定义一个常量。常量通常都需要指定一个具体的数据类型</strong></em></p>
<pre><code>1. 必须指定数据类型
2. 常量必须使用大写字母，使用const关键字
3. 必须使用常量表达式进行赋值，编译器在编译器就能计算出的值
4. 常量不能重定义（遮蔽）
</code></pre>
 <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MAX_POINTS: <span class="type">i32</span> = <span class="number">100_000</span>;</span><br></pre></td></tr></table></figure>

<p><em><strong>不可变变量和常量的区别</strong></em></p>
<ol>
<li>常量使用const声明，不可变变量使用let声明</li>
<li>常量是只读的，不可变变量可以修改</li>
<li>常量在编译器就确定，不能在运行时改变。不可变变量知道在运行期才能确定</li>
<li>常量必须使用大写字母，不可变变量不需要</li>
<li>常量必须声明类型，不可变变量不需要声明类型（编译器可以根据值（上下文）推算出来</li>
</ol>
<h2 id="静态变量"><a href="#静态变量" class="headerlink" title="静态变量"></a>静态变量</h2><pre><code>1. 静态变量使用static关键字进行声明并在编译器分配内存，在程序运行期间一直存在。
2. 静态变量在整个程序中共享，并且可以在多个线程之间共享。
3. 静态变量的值在程序运行期间不会被改变，因此他们通常用于存储程序的全局状态。
</code></pre>
<p><em><strong>与常量的相似之处</strong></em></p>
<ol>
<li>定义方式类型，一个使用static，一个使用const</li>
<li>名称都需要大写，且必须明确指定类型</li>
<li>都必须使用常量表达式进行赋值，且在编译器就能计算出来</li>
<li>都不能被遮蔽</li>
</ol>
<p><em><strong>与常量的区别</strong></em></p>
<ol>
<li>常量在编译时就被内联，但静态变量不会。整个程序中静态变量只有一个实例，也就是说所有引用都指向同一个地址。<br>  2.常量不可变，而静态变量可以通过mut关键字定义为可变<br><em><strong>作用域和遮蔽</strong></em></li>
<li>变量绑定有一个作用域，他被限定只在一个代码块中生存。代码块是被一个{}包围起来的语句集合。允许重新定义变量的值来进行变量遮蔽<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">5</span>;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span> = x + <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;x = &#123;&#125;&quot;</span>, x); <span class="comment">// x = 6 x只在这个&#123;&#125;代码块中有效</span></span><br><span class="line">  &#125;  </span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;x = &#123;&#125;&quot;</span>, x); <span class="comment">// x= 5</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="三、函数"><a href="#三、函数" class="headerlink" title="三、函数"></a>三、函数</h2><p>函数的组成</p>
<ol>
<li>声明函数的关键字 fn。函数位置可以随便放</li>
<li>函数名 funnction_name()</li>
<li>参数i和j 和参数类型 必须指定参数类型 </li>
<li>函数体：{ }</li>
<li>返回值：需指定类型、没有返回值，用-&gt;表示，编译器会默认加上一个-&gt;()。函数永远不会返回，用-&gt;!表示，一般是程序的函数体中有panic!，无线循环loop,和todo!</li>
</ol>
<h2 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h2><ol>
<li><p>if<br>和其他语言的if else 一样， rust的if else 也是表达式，但是可以返回值</p>
  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">number</span> = <span class="keyword">if</span> <span class="literal">true</span> &#123; </span><br><span class="line">      <span class="number">5</span> </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123; </span><br><span class="line">      <span class="number">6</span> </span><br><span class="line">      &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>loop<br>loop 是一个无限循环，直到条件不满足,使用break才退出</p>
  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用&#x27;loop_name: 和 break &#x27;loop_name跳出指定循环</span></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">main</span>()&#123;</span><br><span class="line">      <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">count</span> = <span class="number">0</span>;</span><br><span class="line">      <span class="symbol">&#x27;outer</span>: <span class="keyword">loop</span> &#123;</span><br><span class="line">        <span class="keyword">loop</span> &#123;</span><br><span class="line">          count += <span class="number">1</span>;</span><br><span class="line">          <span class="keyword">if</span> count == <span class="number">10</span> &#123;</span><br><span class="line">              <span class="built_in">print!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, count);</span><br><span class="line">            <span class="keyword">break</span> <span class="symbol">&#x27;outer</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>while</p>
<p> 当条件为true，执行循环，直到条件不为true</p>
</li>
<li><p>使用for循环遍历集合</p>
<p> <em><strong>a. 使用元组的方式遍历集合： for e in (1..4) 表示便利1到3的整数，for e in (1..&#x3D;4) 表示1到4的整数</strong></em></p>
<p> <em><strong>b. for e in (1..4).rev()倒序遍历</strong></em></p>
</li>
</ol>
  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>()&#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">a</span> = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>];</span><br><span class="line">  <span class="keyword">for</span> <span class="variable">e</span> <span class="keyword">in</span> a &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="三、基础类型"><a href="#三、基础类型" class="headerlink" title="三、基础类型"></a>三、基础类型</h1><h2 id="1-数值类型"><a href="#1-数值类型" class="headerlink" title="1. 数值类型"></a>1. 数值类型</h2><h3 id="整型"><a href="#整型" class="headerlink" title="整型"></a>整型</h3><p>  默认数值类型是i32，数据范围是-(2n - 1) ~ 2n - 1 - 1<br>  <img src="/../images/image.png" alt="alt text"><br>  <img src="/../images/image1.png" alt="alt text"></p>
<h3 id="浮点型"><a href="#浮点型" class="headerlink" title="浮点型"></a>浮点型</h3><p>  默认浮点类型是f64，有精度丢失的问题<br>  <em><strong>对精度要求比较严格时，尽量不适用浮点数</strong></em></p>
<h3 id="NAN是什么？"><a href="#NAN是什么？" class="headerlink" title="NAN是什么？"></a>NAN是什么？</h3><pre><code>对于数学上未定义的结果，例如对负数取平方根 -42.1.sqrt() ，会产生一个特殊的结果：Rust 的浮点数类型使用 NaN (not a number)来处理这些情况。

所有跟 NaN 交互的操作，都会返回一个 NaN，而且 NaN 不能用来比较，下面的代码会崩溃：
</code></pre>
  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span> = (-<span class="number">42.0_f32</span>).<span class="title function_ invoke__">sqrt</span>();</span><br><span class="line">    <span class="built_in">assert_eq!</span>(x, x);</span><br><span class="line">  &#125;</span><br><span class="line">```  </span><br><span class="line">  出于防御性编程的考虑，可以使用 <span class="title function_ invoke__">is_nan</span>() 等方法，可以用来判断一个数值是否是 NaN ：</span><br><span class="line">```rust</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">x</span> = (-<span class="number">42.0_f32</span>).<span class="title function_ invoke__">sqrt</span>();</span><br><span class="line">  <span class="keyword">if</span> x.<span class="title function_ invoke__">is_nan</span>() &#123;</span><br><span class="line">      <span class="built_in">println!</span>(<span class="string">&quot;未定义的数学行为&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="字符"><a href="#字符" class="headerlink" title="字符"></a>字符</h3><p>  Rust 的字符不仅仅是 ASCII，所有的 Unicode 值都可以作为 Rust 字符，包括单个的中文、日文、韩文、emoji 表情符号等等，都是合法的字符类型。Unicode 值的范围从 U+0000 ~ U+D7FF 和 U+E000 ~ U+10FFFF。</p>
<p>  <em><strong>由于 Unicode 都是 4 个字节编码，因此字符类型也是占用 4 个字节</strong></em></p>
<h3 id="序列"><a href="#序列" class="headerlink" title="序列"></a>序列</h3><p>  Rust提供了一个非常简洁的方式，用来生成连续的数值，例如1..5，表示生成1-4的连续数字，不包含5。  1..&#x3D;5表示生成1-5的连续数字，包含5。一般用于循环中。</p>
<h3 id="类型强转"><a href="#类型强转" class="headerlink" title="类型强转"></a>类型强转</h3><p>  Rust 的类型转换非常简单，直接使用 as 关键字</p>
<h1 id="所有权"><a href="#所有权" class="headerlink" title="所有权"></a>所有权</h1><p>  <em><strong>Rust是一种系统编程语言，其设计目的是确保内存安全并防止数据竞争，而不依赖垃圾回收器。这种内存安全性主要通过所有权系统来实现</strong></em></p>
<h2 id="内存回收"><a href="#内存回收" class="headerlink" title="内存回收"></a>内存回收</h2><p>  主流编程语言的内存回收机制对比</p>
<ol>
<li>静态语言</li>
</ol>
<ul>
<li>在编译器对变量类型进行检查和确定，如C，C++，Rust</li>
</ul>
<ol start="2">
<li>动态语言</li>
</ol>
<ul>
<li>在运行时对变量类型进行检查和确定，如Python，JavaScript</li>
</ul>
<p>  回收方式对比</p>
<ol>
<li>C，C++</li>
</ol>
<ul>
<li>内存管理方式：手动管理</li>
<li>特点：<ul>
<li>程序员通过malloc和free（C）或者new 和 delete（C++）手动分配和释放内存</li>
<li>没有内置的垃圾回收机制</li>
</ul>
</li>
<li>优点<ul>
<li>高校且灵活，适用于对性能要求极高的系统级编程</li>
</ul>
</li>
<li>缺点<ul>
<li>容易出现内存泄漏，悬垂指针和缓冲区溢出等问题，需要非常小心的内存管理</li>
</ul>
</li>
</ul>
<ol start="2">
<li>Javascript</li>
</ol>
<ul>
<li>内存管理方式：垃圾回收</li>
<li>特点<ul>
<li>浏览器和Nodejs环境中均使用垃圾回收器（如V8引擎的垃圾回收器）。</li>
<li>采用标记-清除，标记-压缩等分代回收算法</li>
</ul>
</li>
<li>优点： 自动内存管理</li>
<li>缺点：垃圾回收器在某些情况下会导致性能问题</li>
</ul>
<ol start="3">
<li>Rust</li>
</ol>
<ul>
<li>内存管理方式：所有权系统</li>
<li>特点：<ul>
<li>使用所有权进行内存管理，编译器在编译时通过静态分析来确保内存安全</li>
<li>每个值都有一个所有者，在任何时候只能有一个有效的所有者</li>
<li>通过借用（引用）机制来共享数据，同时保证数据竞争和悬垂指针的安全</li>
</ul>
</li>
<li>优点<ul>
<li>在编译器保证内存安全，没有运行时开销</li>
<li>避免了数据竞争和悬垂指针</li>
</ul>
</li>
<li>缺点<ul>
<li>需要程序员理解和遵循所有权和借用规则，学习路线陡峭</li>
</ul>
</li>
</ul>
<p>  <em><strong>所有权的基本规则</strong></em><br>  Rust的所有权系统有三个基本规则</p>
<ol>
<li>每一个值都有一个所有者</li>
<li>在任一时刻，值只能有一个所有者</li>
<li>当所有者离开作用域，值会被丢弃</li>
</ol>
<h1 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h1><ul>
<li>不可变引用：可以读取数据，但不能修改。一个变量可以有多个不可变引用，但不能与可变引用共存。</li>
<li>可变引用：可变引用可以修改数据（前提被引用的变量是可变的）。一个变量在某一时刻只能有一个可变引用，且不能与不可变引用共存。</li>
</ul>
<h2 id="引用的规则"><a href="#引用的规则" class="headerlink" title="引用的规则"></a>引用的规则</h2><ul>
<li>在同一时间内，一个变量只能有一个可变引用和多个不可变引用</li>
<li>引用必须总是有效</li>
</ul>
<p>  引用规则VS所有权规则<br>  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable">r1</span> = &amp;s;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">r2</span> = &amp;s;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;r1&#125; and &#123;r2&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable">r3</span> = &amp;<span class="keyword">mut</span> s;</span><br><span class="line"></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;r3&#125;&quot;</span>);</span><br></pre></td></tr></table></figure></p>
<h2 id="move-borrowing-referencing"><a href="#move-borrowing-referencing" class="headerlink" title="move &amp; borrowing &amp; referencing"></a>move &amp; borrowing &amp; referencing</h2><ul>
<li>move 堆数据所有权</li>
<li>borrowing 函数</li>
<li>referencing 变量</li>
</ul>
<h2 id="切片-（Slices）"><a href="#切片-（Slices）" class="headerlink" title="切片 （Slices）"></a>切片 （Slices）</h2><ul>
<li>字符串切片： 对字符串部分内容的引用<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">hello</span> = &amp;s[<span class="number">0</span>..<span class="number">5</span>]; <span class="comment">// 引用&quot;hello&quot;</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">world</span> = &amp;s[<span class="number">6</span>..<span class="number">11</span>]; <span class="comment">// 引用 &quot;world&quot;</span></span><br></pre></td></tr></table></figure></li>
<li>数组切片: 与字符串切片类似<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">arr</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> <span class="variable">slice</span> = &amp;arr[<span class="number">1</span>..<span class="number">3</span>]; <span class="comment">// 引用数组切片 [2, 3]</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="生命周期-（lifetimes）"><a href="#生命周期-（lifetimes）" class="headerlink" title="生命周期 （lifetimes）"></a>生命周期 （lifetimes）</h2><p>  <em><strong>生命周期是rust用来保证引用有效性的机制。生命周期注解允许编译器推断引用的有效范围，确保在引用仍然有效时使用它们。</strong></em><br>  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">a</span> = <span class="title function_ invoke__">get_a</span>();</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">get_a</span>() <span class="punctuation">-&gt;</span> &amp;<span class="type">String</span> &#123;</span><br><span class="line">  &amp;<span class="string">&quot;a&quot;</span>.<span class="title function_ invoke__">to_string</span>() <span class="comment">// 这里方法结束&quot;字符串a会被释放&quot;,返回的引用会造成悬垂指针问题</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="数组和切片"><a href="#数组和切片" class="headerlink" title="数组和切片"></a>数组和切片</h1><h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><ul>
<li>数组的定义为分配一段连续相同数据类型的内存块</li>
<li>数组是静态的，这意味着一旦定义和初始化，则永远不可更改它的长度。</li>
<li>数组的元素有着相同数据类型，每一个元素都独占数据类型大小的内存块。也就是说，数组的内存大小 &#x3D; 数组长度 * 数组元素类型大小。</li>
<li>数组中的每一个元素都按照顺序一次存储，这个顺序即代表着元素的存储位置，也是数组元素的唯一标识，这个标识为数组下标。</li>
<li>填充数组中的每一个元素的过程称为<em><strong>数组初始化</strong></em></li>
<li>可以更新或者修改数组元素的值，但不能删除数组元素。如果要删除的话可以将值替换为0或者其他表示删除的值。</li>
<li>当数组作为参数传入函数时，传入的是数组的拷贝，函数对数组值进行改变时，不会影响原数组。除非传递数组的引用</li>
</ul>
<h2 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h2><p>  <em><strong>Slice类型通常翻译为切片，他表示从某个包含多个元素的容器中取得局部数据，这个过程称之为切片操作。</strong></em></p>
<p>  <em><strong>Rust中的切片操作只允许获取一段连续的局部数据，切片操作获取到的数据称为切片数据。支持Slice操作的数据类型有三种：String、Array、Vec。</strong></em></p>
<h3 id="切片的常用函数"><a href="#切片的常用函数" class="headerlink" title="切片的常用函数"></a>切片的常用函数</h3><ul>
<li>len() 取slice的元素个数</li>
<li>is_empty() 判断slice是否为空</li>
<li>contains() 判断slice是否包含某个元素</li>
<li>repeat(): 重复slice指定次数</li>
<li>reverse() 反转slice</li>
<li>join() 将各元素压平 并通过指定的分隔符连接起来</li>
<li>swap（） 交换两个索引处的元素，如 s.swap(1,3)</li>
<li>windows() 以指定大小的窗口进行滚动迭代</li>
<li>starts_with() 判断slice是否以某个slice开头</li>
</ul>
<h1 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h1><p><em><strong>字符串的两种创建方式</strong></em></p>
<ul>
<li>字符串字面量： 以双引号””包围的文本，如”hello”<ul>
<li>字符串字面量是不可变的，一旦创建就不能修改</li>
<li>字符串字面量是静态分配的，在编译时确定其内存大小</li>
</ul>
</li>
<li>String类型： 使用String::from()创建，如String::from(“hello”)或”hello”.to_string()<ul>
<li>String类型是可变的，支持在运行时动态增长和修改</li>
<li>String类型是动态分配的，在运行时确定其内存大小</li>
<li>String类型存储在堆上，可以通过函数修改</li>
</ul>
</li>
</ul>
<p><em><strong>String类型api文档</strong></em></p>
<p><a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/string/struct.String.html#:~:text=You%20can%20create%20a%20String%20from%20a%20literal%20string%20with">https://doc.rust-lang.org/std/string/struct.String.html#:~:text=You%20can%20create%20a%20String%20from%20a%20literal%20string%20with</a></p>
<h1 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h1><h2 id="语法-规范"><a href="#语法-规范" class="headerlink" title="语法&amp;规范"></a>语法&amp;规范</h2><p>&#x2F;&#x2F; 关联函数、methods方法的使用和区别，可以混用吗？比如在关联函数中使用&amp;self作为入参？是根据入参来决定这个方法是关联函数还是methods方法？</p>
<ul>
<li>语法<ul>
<li>field-less enum 无字段枚举</li>
<li>unit-only enum 仅单位枚举<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">FieldLessEnum</span> &#123;</span><br><span class="line">  <span class="title function_ invoke__">Tuple</span>(),</span><br><span class="line">  Struct&#123;&#125;,</span><br><span class="line">  Unit,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">UnitOnlyEnum</span> &#123;</span><br><span class="line">  Foo = <span class="number">0</span>,</span><br><span class="line">  Bar = <span class="number">1</span>,</span><br><span class="line">  Baz = <span class="number">2</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">UnitOnlyEnum2</span> &#123;</span><br><span class="line">  Foo,</span><br><span class="line">  Bar,</span><br><span class="line">  Baz,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>规范<ul>
<li>枚举类型名称通常使用大驼峰命名法，如 Option、Result、FieldLessEnum、UnitOnlyEnum、UnitOnlyEnum2</li>
</ul>
</li>
<li>用法<ul>
<li>关联函数</li>
<li>methods方法<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line"></span><br><span class="line">   <span class="meta">#[derive(Debug)]</span></span><br><span class="line">   <span class="keyword">enum</span> <span class="title class_">Pets</span> &#123;</span><br><span class="line">       <span class="title function_ invoke__">Dog</span> (<span class="type">String</span>),</span><br><span class="line">       Cat &#123;name: <span class="type">String</span>,age: <span class="type">usize</span>&#125;, <span class="comment">// 元组结构体</span></span><br><span class="line">       Bird, <span class="comment">//unit type</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">let</span> <span class="variable">my_pet</span> = Pets::<span class="title function_ invoke__">Dog</span>(<span class="string">&quot;Max&quot;</span>.<span class="title function_ invoke__">to_string</span>());</span><br><span class="line">   </span><br><span class="line">    <span class="comment">// methods 方法 入参是当前结构体对象</span></span><br><span class="line">    <span class="keyword">impl</span> <span class="title class_">Pets</span> &#123;</span><br><span class="line">       <span class="keyword">fn</span> <span class="title function_">speak</span>(&amp;<span class="keyword">self</span>) &#123;</span><br><span class="line">           <span class="built_in">println!</span>(<span class="string">&quot;I am a pet&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    my_pet.<span class="title function_ invoke__">speak</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 关联函数 通过rust的路径访问形式去调用 Pets::log</span></span><br><span class="line">    <span class="keyword">impl</span> <span class="title class_">Pets</span> &#123;</span><br><span class="line">       <span class="keyword">fn</span> <span class="title function_">log</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">           <span class="built_in">println!</span>(<span class="string">&quot;I am a pet: &#123;&#125;&quot;</span>,name);</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Pets::<span class="title function_ invoke__">log</span>(<span class="string">&quot;Max&quot;</span>.<span class="title function_ invoke__">to_string</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- 枚举的比较 </span><br><span class="line"> - 用<span class="meta">#[derive(PartialEq)]</span>派生</span><br><span class="line"> - matches 和 <span class="keyword">if</span> <span class="keyword">let</span> 语法</span><br><span class="line"> ```rust</span><br><span class="line"> <span class="comment">// matche 必须匹配完整，需考虑到所有的范围</span></span><br><span class="line"> <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">   <span class="keyword">enum</span> <span class="title class_">Pets</span>&#123;</span><br><span class="line">     Cat,</span><br><span class="line">     Dog,</span><br><span class="line">     Bird,</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">match</span> my_pet &#123;</span><br><span class="line">     Pets::Cat =&gt; <span class="built_in">println!</span>(<span class="string">&quot;I am a cat&quot;</span>),</span><br><span class="line">     Pets::Dog =&gt; <span class="built_in">println!</span>(<span class="string">&quot;I am a dog&quot;</span>),</span><br><span class="line">     _ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;I am a bird&quot;</span>),</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="comment">// if let 语法 只关注一个或者多个值匹配</span></span><br><span class="line"> <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">   <span class="keyword">let</span> <span class="variable">my_pet</span> = Pets::Cat;</span><br><span class="line">   <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Pets</span>::Cat = my_pet &#123;</span><br><span class="line">     <span class="built_in">println!</span>(<span class="string">&quot;I am a cat&quot;</span>);</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">     <span class="built_in">println!</span>(<span class="string">&quot;I am not a cat&quot;</span>);</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>Option 枚举类型 (处理空引用问题)<br>-用法  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="comment">// hashmap返回的是Option类型</span></span><br><span class="line">  <span class="keyword">let</span> <span class="variable">map</span>: HashMap&lt;&amp;<span class="type">str</span>, <span class="type">i32</span>&gt; = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">a</span>  = map.<span class="title function_ invoke__">get</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">  <span class="keyword">match</span> a &#123;</span><br><span class="line">    <span class="title function_ invoke__">Some</span>(n) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;a is: &#123;&#125;&quot;</span>, n),</span><br><span class="line">    <span class="literal">None</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;a is none&quot;</span>),</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 动态数组返回的也是Option类型</span></span><br><span class="line">  <span class="keyword">let</span> <span class="variable">arr</span> = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">b</span> = arr.<span class="title function_ invoke__">get</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">match</span> b &#123;</span><br><span class="line">    <span class="title function_ invoke__">Some</span>(n) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;b is: &#123;&#125;&quot;</span>, n),</span><br><span class="line">    <span class="literal">None</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;b is none&quot;</span>),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Result 枚举类型<ul>
<li><p>Ok<T></p>
</li>
<li><p>Err<E></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">result</span>: <span class="type">Result</span>&lt;<span class="type">usize</span>,()&gt; = <span class="title function_ invoke__">Ok</span>(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">match</span> result &#123;</span><br><span class="line">      <span class="title function_ invoke__">Ok</span>(n) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;result is: &#123;&#125;&quot;</span>, n),</span><br><span class="line">      <span class="title function_ invoke__">Err</span>(_) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;error&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">len</span>: <span class="type">Result</span>&lt;<span class="type">usize</span>, ParseIntError&gt; = <span class="string">&quot;23&quot;</span>.<span class="title function_ invoke__">parse</span>();</span><br><span class="line">    <span class="keyword">match</span> len &#123;</span><br><span class="line">      <span class="title function_ invoke__">Ok</span>(n) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;len is: &#123;&#125;&quot;</span>, n),</span><br><span class="line">      <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;error: &#123;&#125;&quot;</span>, e),</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">file</span> = File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;hello.txt&quot;</span>);</span><br><span class="line">    <span class="keyword">match</span> file &#123;</span><br><span class="line">      <span class="title function_ invoke__">Ok</span>(file) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;file is: &#123;&#125;&quot;</span>, file),</span><br><span class="line">      <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;error: &#123;&#125;&quot;</span>, e),</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">tcp</span> = TcpStream::<span class="title function_ invoke__">connect</span>(<span class="string">&quot;127.0.0.1:8080&quot;</span>);</span><br><span class="line">    <span class="keyword">match</span> tcp &#123;</span><br><span class="line">      <span class="title function_ invoke__">Ok</span>(tcp) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;tcp is: &#123;&#125;&quot;</span>, tcp),</span><br><span class="line">      <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;error: &#123;&#125;&quot;</span>, e),</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">- <span class="type">Option</span> 和 <span class="type">Result</span>的转换</span><br><span class="line">   - <span class="type">Option</span> 转 <span class="type">Result</span></span><br><span class="line">    ```rust</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">      <span class="comment">// 使用.ok_or()方法将Option&lt;T&gt;转换为Result&lt;T, E&gt;</span></span><br><span class="line">      <span class="keyword">let</span> <span class="variable">opt</span>: <span class="type">Option</span>&lt;<span class="type">i32</span>&gt; = <span class="title function_ invoke__">Some</span>(<span class="number">10</span>);</span><br><span class="line">      <span class="keyword">let</span> <span class="variable">result</span>: <span class="type">Result</span>&lt;<span class="type">i32</span>, &amp;<span class="type">str</span>&gt; = opt.<span class="title function_ invoke__">ok_or</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">      <span class="built_in">assert_eq!</span>(result, <span class="title function_ invoke__">Ok</span>(<span class="number">42</span>));</span><br><span class="line"></span><br><span class="line">      <span class="keyword">let</span> <span class="variable">none</span>: <span class="type">Option</span>&lt;<span class="type">i32</span>&gt; = <span class="literal">None</span>;</span><br><span class="line">      <span class="keyword">let</span> <span class="variable">result_none</span>: <span class="type">Result</span>&lt;<span class="type">i32</span>, &amp;<span class="type">str</span>&gt; = none.<span class="title function_ invoke__">ok_or</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">      <span class="built_in">assert_eq!</span>(result_none, <span class="title function_ invoke__">Err</span>(<span class="string">&quot;error&quot;</span>));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Result 转 Option</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="comment">// 使用.ok()方法将Result&lt;T, E&gt;转换为Option&lt;T&gt;</span></span><br><span class="line">  <span class="keyword">let</span> <span class="variable">result</span>: <span class="type">Result</span>&lt;<span class="type">i32</span>, &amp;<span class="type">str</span>&gt; = <span class="title function_ invoke__">Ok</span>(<span class="number">42</span>);</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">opt</span>: <span class="type">Option</span>&lt;<span class="type">i32</span>&gt; = result.<span class="title function_ invoke__">ok</span>();</span><br><span class="line">  <span class="built_in">assert_eq!</span>(opt, <span class="title function_ invoke__">Some</span>(<span class="number">42</span>));</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">result_err</span>: <span class="type">Result</span>&lt;<span class="type">i32</span>, &amp;<span class="type">str</span>&gt; = <span class="title function_ invoke__">Err</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">opt_err</span>: <span class="type">Option</span>&lt;<span class="type">i32</span>&gt; = result_err.<span class="title function_ invoke__">ok</span>();</span><br><span class="line">  <span class="comment">// error类型会返回None</span></span><br><span class="line">  <span class="built_in">assert_eq!</span>(opt_err, <span class="literal">None</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Option 常见api  </p>
<ul>
<li>unwrap() 返回Some中的值，如果是None会panic</li>
<li>expect(msg) 返回Some中的值，如果是None会panic，msg是错误信息</li>
<li>is_some() 判断是否为Some</li>
<li>is_none() 判断是否为None</li>
<li>map(f) 对Some中的值应用函数f，返回新的Option</li>
<li>and_then(f) 对Some中的值应用函数f，返回新的Option，如果是None会返回None</li>
<li>or_else(f) 对None应用函数f，返回新的Option，如果是Some会返回Some</li>
</ul>
</li>
<li><p>Result 常见api  </p>
<ul>
<li>unwrap() 返回Ok中的值，如果是Err会panic</li>
<li>expect(msg) 返回Ok中的值，如果是Err会panic，msg是错误信息</li>
<li>is_ok() 判断是否为Ok</li>
<li>is_err() 判断是否为Err</li>
<li>map(f) 对Ok中的值应用函数f，返回新的Result</li>
<li>and_then(f) 对Ok中的值应用函数f，返回新的Result，如果是Err会返回Err</li>
<li>or_else(f) 对Err应用函数f，返回新的Result，如果是Ok会返回Ok</li>
<li>map_err(f) 对Err中的值应用函数f，返回新的Result</li>
</ul>
</li>
<li><p>枚举值的内存占用</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 依据最大的变体size 0 (unit type) 1 (i32) 2 (bool) 4 (String)</span></span><br><span class="line"><span class="comment">// 判别式</span></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">MyEnum</span> &#123;</span><br><span class="line">      A, <span class="comment">// 0</span></span><br><span class="line">      B, <span class="comment">// 1</span></span><br><span class="line">      C, <span class="comment">// 2</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;size of MyEnum: &#123;&#125;&quot;</span>, std::mem::size_of::&lt;MyEnum&gt;());</span><br><span class="line">    <span class="comment">// 1</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; 课后习题</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">enum</span> <span class="title class_">MyEnum</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">A</span>(<span class="type">u8</span>,<span class="type">u8</span>),</span><br><span class="line">    B,</span><br><span class="line">    C &#123;&#125;,</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">enum</span> <span class="title class_">EnumA</span> &#123;</span><br><span class="line">    A = <span class="number">255</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">enum</span> <span class="title class_">EnumB</span> &#123;</span><br><span class="line">    A = <span class="number">255</span>,</span><br><span class="line">    B,</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 分析enum的内存大小，并打印出来</span></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="comment">// 3  两个字节存储u8,一个字节标记当前是哪个变体</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;size of MyEnum: &#123;&#125;&quot;</span>, std::mem::size_of::&lt;MyEnum&gt;());</span><br><span class="line">    <span class="comment">// 0 只有一个变体，没有关联数据， A=255在编译时就已知，不需存储到内存</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;size of EnumA: &#123;&#125;&quot;</span>, std::mem::size_of::&lt;EnumA&gt;());</span><br><span class="line">    <span class="comment">// 2 </span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;size of EnumB: &#123;&#125;&quot;</span>, std::mem::size_of::&lt;EnumB&gt;());</span><br><span class="line">  &#125;</span><br><span class="line">  ```    </span><br><span class="line"># 结构体</span><br><span class="line">  ## 结构体的初始化</span><br><span class="line">  ```rust</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">User</span> &#123;</span><br><span class="line">      active: <span class="type">bool</span>,</span><br><span class="line">      username: <span class="type">String</span>,</span><br><span class="line">      email: <span class="type">String</span>,</span><br><span class="line">      sign_in_count: <span class="type">u64</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">      <span class="comment">// 1. 每一个字段必须被初始化</span></span><br><span class="line">      <span class="comment">// 2. 字段顺序必须和结构体定义顺序不需要一致</span></span><br><span class="line">      <span class="comment">// 3. 字段名使用逗号分隔</span></span><br><span class="line">      <span class="comment">// 4. 变量名和结构体变量相同，可以省略</span></span><br><span class="line">      <span class="keyword">let</span> <span class="variable">user</span> = User &#123;</span><br><span class="line">        username: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;user1&quot;</span>),</span><br><span class="line">        email: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;user1@example.com&quot;</span>),</span><br><span class="line">        sign_in_count: <span class="number">1</span>,</span><br><span class="line">        active: <span class="literal">true</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">// 结构体更新语法</span></span><br><span class="line">      <span class="keyword">let</span> <span class="variable">_user1</span> = User &#123;</span><br><span class="line">        username: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;user1&quot;</span>),</span><br><span class="line">        <span class="comment">// 为什么要加入这行代码，创建user2 才不会报错所有权问题</span></span><br><span class="line">        email: user.email.<span class="title function_ invoke__">clone</span>(), <span class="comment">// 克隆 email</span></span><br><span class="line">        ..user</span><br><span class="line">    &#125;;</span><br><span class="line">      <span class="comment">// 更新结构体字段,设置结构体为可变</span></span><br><span class="line">      <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">user2</span> = User &#123;</span><br><span class="line">        username: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;user2&quot;</span>),</span><br><span class="line">        ..user</span><br><span class="line">      &#125;;</span><br><span class="line">      user2.email = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;user2@example.com&quot;</span>);</span><br><span class="line">      user2.active = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">      <span class="built_in">print!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, user2.email)</span><br><span class="line">      <span class="comment">// 元组结构体： 结构体必须要有名称，但是字段可以不用有名称</span></span><br><span class="line">      <span class="keyword">struct</span> <span class="title class_">Color</span>(<span class="type">i32</span>, <span class="type">i32</span>, <span class="type">i32</span>);</span><br><span class="line">      <span class="keyword">let</span> <span class="variable">color</span> = <span class="title function_ invoke__">Color</span>(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">      <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, color.<span class="number">0</span>);</span><br><span class="line">      <span class="comment">// 单元结构体：定义一个类型，但是不关心这个类型的内容，只关心行为</span></span><br><span class="line">      <span class="keyword">struct</span> <span class="title class_">AlwaysEqual</span>;</span><br><span class="line">      <span class="keyword">let</span> <span class="variable">subject</span> = AlwaysEqual;</span><br><span class="line">      <span class="comment">// 不关心AlwaysEqual的字段数据，只关心他的行为，声明为单元结构体然后实现某个特征</span></span><br><span class="line">      <span class="keyword">impl</span> <span class="title class_">SomeTrait</span> <span class="keyword">for</span> <span class="title class_">AlwaysEqual</span> &#123;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="所有权-1"><a href="#所有权-1" class="headerlink" title="所有权"></a>所有权</h2><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 所有权的范围，字段</span></span><br><span class="line"><span class="comment">// 2. 实现了Copy特征的字段类型（基本类型），可以辅助</span></span><br><span class="line"><span class="comment">// 3. 没有实现Copy特征的字段类型，会发生所有权的转移</span></span><br><span class="line"><span class="comment">// 4、一旦结构体中的一个字段发生所有权移动，那么这个结构体就不能再被赋值了</span></span><br><span class="line"><span class="comment">// 5. 结构体更新语法会发生所有权的移动</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">user1</span> = User &#123;</span><br><span class="line">      username: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;user1&quot;</span>),</span><br><span class="line">      email: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;user1@example.com&quot;</span>),</span><br><span class="line">      sign_in_count: <span class="number">1</span>,</span><br><span class="line">      active: <span class="literal">true</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 所有权已经转移，print(user1)会报错</span></span><br><span class="line">  <span class="keyword">let</span> <span class="variable">user2</span> = User &#123;</span><br><span class="line">    email: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;user2@example.com&quot;</span>),</span><br><span class="line">    ..user1</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 如果把字段类型设置为引用类型比如</span></span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">UserInfo</span> &#123;</span><br><span class="line">    active: <span class="type">bool</span>,</span><br><span class="line">    username: &amp;<span class="type">str</span>,</span><br><span class="line">    email: &amp;<span class="type">str</span>,</span><br><span class="line">    sign_in_count: <span class="type">u64</span>,</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 那么需要给整个结构体加上声明周期，整体的写法改为</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">UserInfo</span>&lt;`a&gt; &#123;</span><br><span class="line">    active: <span class="type">bool</span>,</span><br><span class="line">    username: &amp;`a <span class="type">str</span>,</span><br><span class="line">    email: &amp;`a <span class="type">str</span>,</span><br><span class="line">    sign_in_count: <span class="type">u64</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><ul>
<li>定义方法<ul>
<li>使用fn 关键字声明，可以拥有参数和返回值，同时包含在某处调用方法时会执行的代码</li>
<li>方法与函数不同，方法在结构体上下文被定义，第一个参数总是self,代表结构体的实例<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">  width: <span class="type">u32</span>,</span><br><span class="line">  height: <span class="type">u32</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">area</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">u32</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.width * <span class="keyword">self</span>.height;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// rust中只能通过函数来访问结构体字段，不能直接访问</span></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">width</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">u32</span> &#123;</span><br><span class="line">    <span class="keyword">self</span>.width;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 关联函数 使用Rectangle::new()实例化结构体</span></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">new</span> (width: <span class="type">u32</span>, height: <span class="type">u32</span>) <span class="punctuation">-&gt;</span> Rectangle &#123;</span><br><span class="line">    <span class="keyword">return</span> Rectangle &#123;width, height&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">rect</span> = Rectangle &#123;width:<span class="number">1</span>,height:<span class="number">2</span>&#125;;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, rect.<span class="title function_ invoke__">area</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="为类型实现特征"><a href="#为类型实现特征" class="headerlink" title="为类型实现特征"></a>为类型实现特征</h2><p> <em><strong>如果不同的类型具有相同的行为，那么就可以定义一个特征（接口），然后为这些类型实现特征</strong></em><br> <em><strong>特征就是把一些方法组合在一起，目的是定义一个实现某些目标所必须的行为集合</strong></em></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">trait</span> <span class="title class_">Shape</span> &#123;</span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">area</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">f64</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Shape</span> <span class="keyword">for</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">area</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">f64</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.width <span class="keyword">as</span> <span class="type">f64</span> * <span class="keyword">self</span>.height <span class="keyword">as</span> <span class="type">f64</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="打印一个结构体"><a href="#打印一个结构体" class="headerlink" title="打印一个结构体"></a>打印一个结构体</h2><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">rect</span> = Rectangle &#123;width:<span class="number">1</span>,height:<span class="number">2</span>&#125;;</span><br><span class="line"><span class="comment">// 1. 在结构体上使用#[derive(Debug)] 实现了debug的trait，可以打印出结构体的所有字段</span></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, rect);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;:#?&#125;&quot;</span>, rect);</span><br><span class="line">dbg!(rect);</span><br><span class="line"><span class="comment">// 2. 为自己的结构体实现Display特征，实现自定义的打印格式</span></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Display</span> <span class="keyword">for</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">fmt</span>(&amp;<span class="keyword">self</span>, f: &amp;<span class="keyword">mut</span> std::fmt::Formatter&lt;<span class="symbol">&#x27;_</span>&gt;) <span class="punctuation">-&gt;</span> std::fmt::<span class="type">Result</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> <span class="variable">_</span> <span class="keyword">in</span> <span class="number">0</span>..<span class="keyword">self</span>.height &#123;</span><br><span class="line">      <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s</span>  = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">      <span class="keyword">for</span> <span class="variable">_</span> <span class="keyword">in</span> <span class="number">0</span>..<span class="keyword">self</span>.width &#123;</span><br><span class="line">        s.<span class="title function_ invoke__">push</span>(<span class="string">&#x27;#&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">write!</span>(f, <span class="string">&quot;&#123;&#125;&quot;</span>, s);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">Ok</span>(());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 实现debug特征</span></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Debug</span> <span class="keyword">for</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">fmt</span>(&amp;<span class="keyword">self</span>, f: &amp;<span class="keyword">mut</span> std::fmt::Formatter&lt;<span class="symbol">&#x27;_</span>&gt;) <span class="punctuation">-&gt;</span> std::fmt::<span class="type">Result</span> &#123;</span><br><span class="line">    <span class="built_in">write!</span>(f, <span class="string">&quot;Rectangle &#123;&#123; width: &#123;&#125;, height: &#123;&#125; &#125;&#125;&quot;</span>, <span class="keyword">self</span>.width, <span class="keyword">self</span>.height)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="匹配模式"><a href="#匹配模式" class="headerlink" title="匹配模式"></a>匹配模式</h1><h2 id="match表达式"><a href="#match表达式" class="headerlink" title="match表达式"></a>match表达式</h2><ul>
<li>基本用法：match语句可以用于模式匹配数据子、字符串、枚举等<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基本模式</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">number</span> = <span class="number">13</span>;</span><br><span class="line"><span class="keyword">match</span> number &#123;</span><br><span class="line">  <span class="number">1</span> = &gt; <span class="built_in">println!</span>(<span class="string">&quot;one&quot;</span>),</span><br><span class="line">  <span class="number">2</span> = &gt; <span class="built_in">println!</span>(<span class="string">&quot;two&quot;</span>),</span><br><span class="line">  _ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;other&quot;</span>),</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 字面值模式</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">x</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">y</span>: &amp;<span class="type">str</span> = <span class="string">&quot;&quot;</span>Hello;</span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">  <span class="number">1</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;one&quot;</span>),</span><br><span class="line">  _ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;other&quot;</span>),</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">match</span> y &#123;</span><br><span class="line">  <span class="string">&quot;Hello&quot;</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Hello&quot;</span>),</span><br><span class="line">  <span class="string">&quot;GoodBye&quot;</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;GoodBye&quot;</span>),</span><br><span class="line">  _ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;other&quot;</span>),</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 变量模式 将x赋值给var进行匹配</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">x</span>: <span class="type">i32</span> = <span class="number">42</span>;</span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">  var: <span class="type">i32</span> = &gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, var),</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">str</span> = <span class="string">&quot;Hello&quot;</span>.<span class="title function_ invoke__">to_string</span>();</span><br><span class="line"><span class="keyword">match</span> <span class="type">str</span> &#123;</span><br><span class="line">  var: <span class="type">String</span> = &gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, var),</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 如果不是基本类型，模式匹配会发生所有权转移，这里会打印失败</span></span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, <span class="type">str</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结构模式</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Point</span> &#123;x:<span class="type">i32</span>, y:<span class="type">i32</span>&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">p</span> = Point &#123;x:<span class="number">1</span>, y:<span class="number">2</span>&#125;;</span><br><span class="line"><span class="keyword">match</span> p &#123;</span><br><span class="line">  Point &#123;x, y: <span class="number">0</span>&#125; =&gt; <span class="built_in">println!</span>(<span class="string">&quot;x:&#123;&#125;, y:&#123;&#125;&quot;</span>, x, y),</span><br><span class="line">  Point &#123;x: <span class="number">0</span>, y&#125; =&gt; <span class="built_in">println!</span>(<span class="string">&quot;x:&#123;&#125;, y:&#123;&#125;&quot;</span>, x, y),</span><br><span class="line">  Point &#123;x, y&#125; =&gt; <span class="built_in">println!</span>(<span class="string">&quot;x:&#123;&#125;, y:&#123;&#125;&quot;</span>, x, y),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 守卫 ： 在模式匹配中，可以使用守卫来添加额外的条件判断</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">x</span> = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">  n <span class="keyword">if</span> n % <span class="number">2</span> == <span class="number">0</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; is even&quot;</span>, n),</span><br><span class="line">  n =&gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; is odd&quot;</span>, n),</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 绑定： 在模式匹配中，可以使用绑定来将模式中的值绑定到变量上</span></span><br><span class="line"><span class="comment">// @ 将匹配模式的范围进行值绑定</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">x</span> = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">match</span> x &#123;</span><br><span class="line">  var @ <span class="number">1</span>..=<span class="number">5</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; is between 1 and 5&quot;</span>, var),</span><br><span class="line">  _ =&gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; is not between 1 and 5&quot;</span>, x),</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">  Hello &#123;id: <span class="type">i32</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">msg</span> = Message::Hello &#123;id: <span class="number">5</span>&#125;;</span><br><span class="line"><span class="keyword">match</span> msg &#123;</span><br><span class="line">  <span class="comment">// 将id的值赋给var，并且范围在(3,7]</span></span><br><span class="line">  Message::Hello &#123;id:var @ <span class="number">3</span>..=<span class="number">7</span>&#125; =&gt; <span class="built_in">println!</span>(<span class="string">&quot;id is &#123;&#125;&quot;</span>, var),</span><br><span class="line">  Message::Hello &#123;id: _&#125; =&gt; <span class="built_in">println!</span>(<span class="string">&quot;id is not between 3 and 7&quot;</span>),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="匹配模式的应用场景"><a href="#匹配模式的应用场景" class="headerlink" title="匹配模式的应用场景"></a>匹配模式的应用场景</h2><ul>
<li>处理错误</li>
<li>解析命令行参数</li>
<li>解析配置文件</li>
<li>解析数据包</li>
<li>解析XML或者JSON等数据格式<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">devide</span>(a: <span class="type">i32</span>, b: <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">i32</span>, <span class="type">String</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> b == <span class="number">0</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">Err</span>(<span class="string">&quot;Divide by zero&quot;</span>.<span class="title function_ invoke__">to_string</span>())</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(a / b)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="keyword">match</span> <span class="title function_ invoke__">devide</span>(<span class="number">10</span>, <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(result) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, result),</span><br><span class="line">    <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, e),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>高级匹配技巧<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">  Quit,</span><br><span class="line">  Move &#123;x: <span class="type">i32</span>, y: <span class="type">i32</span>&#125;,</span><br><span class="line">  <span class="title function_ invoke__">Write</span>(<span class="type">String</span>),</span><br><span class="line">  <span class="title function_ invoke__">ChangeColor</span>(<span class="type">i32</span>, <span class="type">i32</span>, <span class="type">i32</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable">msg</span> = Message::<span class="title function_ invoke__">ChangeColor</span>(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">match</span> msg &#123;</span><br><span class="line">  Message::<span class="title function_ invoke__">ChangeColor</span>(r, g, b) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Change color to RGB(&#123;&#125;, &#123;&#125;, &#123;&#125;)&quot;</span>, r, g, b),</span><br><span class="line">  _ =&gt; &#123;&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 匹配模式与迭代器：结合iter和match使用</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">vec1</span> = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> <span class="variable">vec2</span> = <span class="built_in">vec!</span>[<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>];</span><br><span class="line"><span class="keyword">for</span> (a,b) <span class="keyword">in</span> vec1.<span class="title function_ invoke__">iter</span>().<span class="title function_ invoke__">zip</span>(vec2) &#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; + &#123;&#125; = &#123;&#125;&quot;</span>,a,b,a+b)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// if lete 和 while let： 简化单个模式匹配</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">opt</span> = <span class="title function_ invoke__">Some</span>(<span class="number">5</span>);</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(x) = opt &#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;Matched &#123;:?&#125;&quot;</span>,x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">iter</span> = <span class="built_in">vec!</span>[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].<span class="title function_ invoke__">into_iter</span>();</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">let</span> <span class="variable">Some</span>(x) = iter.<span class="title function_ invoke__">next</span>() &#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;Matched &#123;:?&#125;&quot;</span>,x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="ref-和-ref-mut"><a href="#ref-和-ref-mut" class="headerlink" title="ref 和 ref mut"></a>ref 和 ref mut</h2><ul>
<li>借用数据而不转移所有权：在某些情况下，你只需要借用数据而不是转移其所有权。例如在递归数据结构中，借用数据可以避免所有权转移带来的复杂性。</li>
<li>在对数据进行修改：使用ref mut 可以在模式匹配时对数据进行修改，而无需转移所有权<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">str</span> = <span class="string">&quot;Hello&quot;</span>.<span class="title function_ invoke__">to_string</span>();</span><br><span class="line"><span class="keyword">match</span> <span class="type">str</span> &#123;</span><br><span class="line">  <span class="keyword">ref</span> var: &amp;<span class="type">String</span> = &gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, var),</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, <span class="type">str</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">str</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line"><span class="keyword">match</span> <span class="type">str</span> &#123;</span><br><span class="line">  <span class="keyword">ref</span> <span class="keyword">mut</span>  var =&gt; &#123;</span><br><span class="line">    *var = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;World&quot;</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, var);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, <span class="type">str</span>);</span><br></pre></td></tr></table></figure></li>
<li>课后习题： 编写一个使用模式匹配解析JSON字符串的程序</li>
<li>作业目标： <ul>
<li>理解如何使用Rust模式匹配功能解析JSON数据</li>
<li>学会使用serde_json库解析JSON数据</li>
<li>联系在实际应用场景中使用模式匹配<br>-作业要求</li>
<li>使用serde_json 库解析JSON字符串</li>
<li>使用模式匹配提取JSON对象中的不同字段</li>
<li>处理不同类型的数据（字符串、数字、数组、嵌套对象）<br>-作业示例<br>假设有一个包含用户信息的JSON字符串<br>{<br>“name”: “John Doe”,<br>“age”: 30,<br>“email”: “<a href="mailto:&#106;&#x6f;&#x68;&#110;&#x40;&#101;&#120;&#x61;&#x6d;&#112;&#108;&#x65;&#x2e;&#x63;&#x6f;&#x6d;">&#106;&#x6f;&#x68;&#110;&#x40;&#101;&#120;&#x61;&#x6d;&#112;&#108;&#x65;&#x2e;&#x63;&#x6f;&#x6d;</a>“,<br>“address”: {<br>  “street”: “123 Main St”,<br>  “city”: “Anytown”,<br>}<br>“phone_numbers”: [“555-555-5555”, “555-555-5556”]<br>}</li>
</ul>
</li>
<li>答案：<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> serde_json::&#123;<span class="type">Result</span>, Value&#125;;</span><br><span class="line"><span class="keyword">use</span> serde::&#123;Deserialize, Serialize&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> <span class="variable">json</span> = <span class="string">r#&quot;</span></span><br><span class="line"><span class="string">  &#123;</span></span><br><span class="line"><span class="string">    &quot;name&quot;: &quot;John Doe&quot;,</span></span><br><span class="line"><span class="string">    &quot;age&quot;: 30,</span></span><br><span class="line"><span class="string">    &quot;email&quot;: &quot;john@example.com&quot;,</span></span><br><span class="line"><span class="string">    &quot;address&quot;: &#123;</span></span><br><span class="line"><span class="string">      &quot;street&quot;: &quot;123 Main St&quot;,</span></span><br><span class="line"><span class="string">      &quot;city&quot;: &quot;Anytown&quot;</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    &quot;phone_numbers&quot;: [&quot;555-555-5555&quot;, &quot;555-555-5556&quot;]</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  &quot;#</span>;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">res</span> = <span class="title function_ invoke__">json_format</span>(json);</span><br><span class="line">  <span class="keyword">match</span> res &#123;</span><br><span class="line">      <span class="title function_ invoke__">Ok</span>(person) =&gt; &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, person);</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="built_in">panic!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, e),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">json_format</span>(json: &amp;<span class="type">str</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;(Person)&gt;&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> <span class="variable">p</span>: Person = serde_json::<span class="title function_ invoke__">from_str</span>(json)?;</span><br><span class="line">  <span class="title function_ invoke__">Ok</span>(p)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[derive(Serialize, Deserialize,Debug)]</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  name: <span class="type">String</span>,</span><br><span class="line">  age: <span class="type">i32</span>,</span><br><span class="line">  email: <span class="type">String</span>,</span><br><span class="line">  address: Address,</span><br><span class="line">  phone_numbers: <span class="type">Vec</span>&lt;<span class="type">String</span>&gt;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#[derive(Serialize, Deserialize,Debug)]</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Address</span>&#123;</span><br><span class="line">  street: <span class="type">String</span>,</span><br><span class="line">  city: <span class="type">String</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="常见集合"><a href="#常见集合" class="headerlink" title="常见集合"></a>常见集合</h1><h2 id="Vector"><a href="#Vector" class="headerlink" title="Vector"></a>Vector</h2><p><em><strong>Vec是一个动态数组，可以根据需要动态增长和缩小。适用于需要按顺序存储数据的场景</strong></em></p>
<ul>
<li>基本操作<ul>
<li>创建和初始化</li>
<li>添加元素</li>
<li>访问元素</li>
<li>修改元素</li>
<li>遍历元素<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">vec_study</span>() &#123;</span><br><span class="line">  <span class="comment">// 创建一个空的vec</span></span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">vec</span>: <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt; = <span class="type">Vec</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">  <span class="comment">// 使用宏创建</span></span><br><span class="line">  &lt;!-- <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">vec</span> = <span class="built_in">vec!</span>[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]; -<span class="punctuation">-&gt;</span></span><br><span class="line">  <span class="comment">// 添加元素</span></span><br><span class="line">  vec.<span class="title function_ invoke__">push</span>(<span class="number">4</span>);</span><br><span class="line">  <span class="comment">// 访问元素</span></span><br><span class="line">  <span class="comment">// 会有数组下标越界的问题</span></span><br><span class="line">  <span class="keyword">let</span> <span class="variable">first</span> = &amp;vec[<span class="number">0</span>];</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;first element: &#123;&#125;&quot;</span>, first);</span><br><span class="line">  <span class="comment">// 使用get方法访问</span></span><br><span class="line">  <span class="keyword">match</span> vec.<span class="title function_ invoke__">get</span>(<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">Some</span>(first) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;first element: &#123;&#125;&quot;</span>, first),</span><br><span class="line">    NONE =&gt; <span class="built_in">println!</span>(<span class="string">&quot;No first element&quot;</span>),</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 修改元素</span></span><br><span class="line">  vec[<span class="number">1</span>] = <span class="number">5</span>;</span><br><span class="line">  <span class="comment">// 遍历</span></span><br><span class="line">  <span class="comment">// 如果不适用&amp;vec引用，那么vec的所有权会发生转移</span></span><br><span class="line">  <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> &amp;vec &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, i);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>进阶用法<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">vec_advance</span>() &#123;</span><br><span class="line">  <span class="keyword">enum</span> <span class="title class_">SpreadsheetCell</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">Int</span>(<span class="type">i32</span>),</span><br><span class="line">    <span class="title function_ invoke__">Float</span>(<span class="type">f64</span>),</span><br><span class="line">    <span class="title function_ invoke__">Test</span>(<span class="type">String</span>),</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 使用枚举存储多种类型</span></span><br><span class="line">  <span class="keyword">let</span> <span class="variable">row</span> = <span class="built_in">vec!</span>[</span><br><span class="line">    SpreadsheetCell::<span class="title function_ invoke__">Int</span>(<span class="number">3</span>),</span><br><span class="line">    SpreadsheetCell::<span class="title function_ invoke__">Float</span>(<span class="number">10.12</span>),</span><br><span class="line">    SpreadsheetCell::<span class="title function_ invoke__">Test</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Hello&quot;</span>))</span><br><span class="line">  ]; </span><br><span class="line">  <span class="comment">// 容量与重新分配</span></span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v</span>: <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt; = <span class="type">Vec</span>::<span class="title function_ invoke__">with_capacity</span>(<span class="number">10</span>);</span><br><span class="line">  v.<span class="title function_ invoke__">push</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;capacity: &#123;&#125;&quot;</span>, v.<span class="title function_ invoke__">capacity</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>Vec的常见陷阱<ul>
<li>不安全的索引访问 ： Vec的索引访问是unsafe的，如果索引越界，可能会导致程序崩溃，建议使用match匹配get方法访问</li>
<li>可变引用和不可变引用的混用： 在同一个作用域下，可变引用和不可变引用不能同时存在，否则会panic<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">fn</span> <span class="title function_">vec_trap</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v</span> = <span class="built_in">vec!</span>[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">first</span> = &amp;v[<span class="number">0</span>];</span><br><span class="line">    <span class="comment">// 上面&amp;v是不可变引用，同时v是可变的，会导致panic</span></span><br><span class="line">    v.<span class="title function_ invoke__">push</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="comment">// 修改成</span></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v</span> = <span class="built_in">vec!</span>[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">let</span> <span class="variable">first</span> = &amp;v[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    v.<span class="title function_ invoke__">push</span>(<span class="number">2</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  ```       </span><br><span class="line">## HashMap</span><br><span class="line">***HashMap是一个键值对存储的数据结构。适用于快速查找数据的场景***</span><br><span class="line">- 创建和初始化</span><br><span class="line">- 访问元素</span><br><span class="line">- 遍历元素</span><br><span class="line">```rust</span><br><span class="line"><span class="comment">// 创建HashMap</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">scores</span>: HashMap&lt;_,_&gt; = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line"><span class="comment">// 插入元素</span></span><br><span class="line">scores.<span class="title function_ invoke__">insert</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Alice&quot;</span>), <span class="number">10</span>);</span><br><span class="line">scores.<span class="title function_ invoke__">insert</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Bob&quot;</span>), <span class="number">20</span>);</span><br><span class="line"><span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, scores);</span><br><span class="line"><span class="comment">// 访问元素</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">name</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Alice&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">score</span>: <span class="type">Option</span>&lt;&amp;<span class="type">i32</span>&gt; = scores.<span class="title function_ invoke__">get</span>(&amp;name);</span><br><span class="line"><span class="keyword">match</span> score &#123;</span><br><span class="line">  <span class="title function_ invoke__">Some</span>(score) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Score for &#123;&#125; is &#123;&#125;&quot;</span>, name, score),</span><br><span class="line">  <span class="literal">None</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;No score found for &#123;&#125;&quot;</span>, name),</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 遍历元素</span></span><br><span class="line"><span class="keyword">for</span> (key, value) <span class="keyword">in</span> &amp;scores &#123;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;: &#123;&#125;&quot;</span>, key, value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>进阶用法<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// insert方法有更新元素的功能，替换原有key对应的value</span></span><br><span class="line"><span class="comment">// Bob对应的值被更新为100</span></span><br><span class="line">scores.<span class="title function_ invoke__">insert</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Bob&quot;</span>), <span class="number">100</span>);</span><br><span class="line"><span class="comment">// key不存在时插入数据，存在的话就不插入</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">entry</span> = scores.<span class="title function_ invoke__">entry</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Kevin&quot;</span>)).<span class="title function_ invoke__">or_insert</span>(<span class="number">50</span>);</span><br><span class="line"><span class="comment">// 更改Kevin的分数 (更新hash表)</span></span><br><span class="line">*entry += <span class="number">10</span>;</span><br><span class="line"><span class="comment">// 合并hash表</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">map1</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">map1.<span class="title function_ invoke__">insert</span>(<span class="string">&quot;a&quot;</span>, <span class="number">1</span>);</span><br><span class="line">map1.<span class="title function_ invoke__">insert</span>(<span class="string">&quot;b&quot;</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">map2</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">map2.<span class="title function_ invoke__">insert</span>(<span class="string">&quot;b&quot;</span>, <span class="number">3</span>);</span><br><span class="line">map2.<span class="title function_ invoke__">insert</span>(<span class="string">&quot;c&quot;</span>, <span class="number">4</span>);</span><br><span class="line"><span class="comment">// 方式1 for循环</span></span><br><span class="line"><span class="keyword">for</span> (k,v) <span class="keyword">in</span> map2&#123;</span><br><span class="line">  <span class="comment">// map1的值会被更新</span></span><br><span class="line">  map1.<span class="title function_ invoke__">insert</span>(k,v);</span><br><span class="line">  <span class="comment">// map1的值不会被更新</span></span><br><span class="line">  map1.<span class="title function_ invoke__">entry</span>(k).<span class="title function_ invoke__">or_insert</span>(v);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>HashMap的常见陷阱<ul>
<li>哈希冲突</li>
<li>值的所有权问题<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">caculate_hash</span>&lt;T:Hash&gt;(t:&amp;T) <span class="punctuation">-&gt;</span> <span class="type">u64</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s</span> = DefaultHasher::<span class="title function_ invoke__">new</span>();</span><br><span class="line">  t.<span class="title function_ invoke__">hash</span>(&amp;<span class="keyword">mut</span> s);</span><br><span class="line">  s.<span class="title function_ invoke__">finish</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 所有权问题： 在insert时会移动所有权，所以需要使用clone</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>习题<ul>
<li>使用Vec实现一个简单的栈、支持push、pop、peek等操作</li>
<li>使用HashMap实现一个字频统计器，统计一个字符串中每个单词出现的频率</li>
<li>使用Vec和HashMap实现一个简单的书籍库存管理系统，可以添加书籍，查询库存，修改库存以及删除书籍</li>
</ul>
</li>
<li>答案<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1、栈</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Stack</span>&lt;T&gt; &#123;</span><br><span class="line">items: <span class="type">Vec</span>&lt;T&gt;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span>&lt;T&gt; Stack&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">new</span>() <span class="punctuation">-&gt;</span> <span class="keyword">Self</span> &#123;</span><br><span class="line">      Stack &#123; items: <span class="type">Vec</span>::<span class="title function_ invoke__">new</span>() &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">push</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, item: T) &#123;</span><br><span class="line">      <span class="keyword">self</span>.items.<span class="title function_ invoke__">push</span>(item);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">pop</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">Option</span>&lt;T&gt; &#123;</span><br><span class="line">      <span class="keyword">self</span>.items.<span class="title function_ invoke__">pop</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">peek</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">Option</span>&lt;&amp;T&gt; &#123;</span><br><span class="line">      <span class="keyword">self</span>.items.<span class="title function_ invoke__">last</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">stack</span> = Stack::<span class="title function_ invoke__">new</span>();</span><br><span class="line"></span><br><span class="line">  stack.<span class="title function_ invoke__">push</span>(<span class="number">1</span>);</span><br><span class="line">  stack.<span class="title function_ invoke__">push</span>(<span class="number">2</span>);</span><br><span class="line">  stack.<span class="title function_ invoke__">push</span>(<span class="number">3</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;Top element: &#123;:?&#125;&quot;</span>, stack.<span class="title function_ invoke__">peek</span>());</span><br><span class="line"></span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;Popped: &#123;:?&#125;&quot;</span>, stack.<span class="title function_ invoke__">pop</span>());</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;Popped: &#123;:?&#125;&quot;</span>, stack.<span class="title function_ invoke__">pop</span>());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;Popped: &#123;:?&#125;&quot;</span>, stack.<span class="title function_ invoke__">pop</span>());</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;Popped: &#123;:?&#125;&quot;</span>, stack.<span class="title function_ invoke__">pop</span>());  <span class="comment">// This will print None</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2、字频统计器</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">count_chars</span>(s: &amp;<span class="type">str</span>) <span class="punctuation">-&gt;</span> HashMap&lt;<span class="type">char</span>, <span class="type">usize</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">char_counts</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> <span class="variable">c</span> <span class="keyword">in</span> s.<span class="title function_ invoke__">chars</span>() &#123;</span><br><span class="line">      *char_counts.<span class="title function_ invoke__">entry</span>(c).<span class="title function_ invoke__">or_insert</span>(<span class="number">0</span>) += <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  char_counts</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 3、书籍库存管理系统</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">book</span> = BookInventory::<span class="title function_ invoke__">new</span>();</span><br><span class="line"></span><br><span class="line">  book.<span class="title function_ invoke__">add_book</span>(<span class="string">&quot;Rust圣经&quot;</span>.<span class="title function_ invoke__">to_string</span>(), <span class="number">12</span>);</span><br><span class="line">  book.<span class="title function_ invoke__">add_book</span>(<span class="string">&quot;Golang圣经&quot;</span>.<span class="title function_ invoke__">to_string</span>(), <span class="number">100</span>);</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">book_opt</span> =  book.<span class="title function_ invoke__">query_book</span>(<span class="string">&quot;Golang圣经&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">count</span> = <span class="keyword">match</span> book_opt &#123;</span><br><span class="line">      <span class="title function_ invoke__">Some</span>(c) =&gt; c,</span><br><span class="line">      <span class="literal">None</span> =&gt; <span class="built_in">panic!</span>(<span class="string">&quot;没有找到&quot;</span>),</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>,count);</span><br><span class="line">  book.<span class="title function_ invoke__">modify_book</span>(<span class="string">&quot;Rust圣经&quot;</span>, <span class="number">1</span>);</span><br><span class="line">  book.<span class="title function_ invoke__">remove_book</span>(<span class="string">&quot;Rust圣经&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">BookInventory</span> &#123;</span><br><span class="line">    <span class="comment">// key:书名 value:库存数量</span></span><br><span class="line">    books: HashMap&lt;<span class="type">String</span>, <span class="type">i32</span>&gt;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">BookInventory</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">new</span>() <span class="punctuation">-&gt;</span> <span class="keyword">Self</span> &#123;</span><br><span class="line">        BookInventory &#123;</span><br><span class="line">            books: HashMap::<span class="title function_ invoke__">new</span>(),</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">add_book</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, name: <span class="type">String</span>, count: <span class="type">i32</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.books.<span class="title function_ invoke__">insert</span>(name, count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">query_book</span>(&amp;<span class="keyword">self</span>, name: &amp;<span class="type">str</span>) <span class="punctuation">-&gt;</span> <span class="type">Option</span>&lt;&amp;<span class="type">i32</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">self</span>.books.<span class="title function_ invoke__">get</span>(name)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">modify_book</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, name: &amp;<span class="type">str</span>, count: <span class="type">i32</span>) &#123;</span><br><span class="line">      <span class="comment">// get_mut ： 获取值的可变引用</span></span><br><span class="line">        <span class="keyword">match</span> <span class="keyword">self</span>.books.<span class="title function_ invoke__">get_mut</span>(name) &#123;</span><br><span class="line">            <span class="title function_ invoke__">Some</span>(c) =&gt; *c = count,</span><br><span class="line">            <span class="literal">None</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;没有找到&#123;&#125;&quot;</span>, name),</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">remove_book</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, name: &amp;<span class="type">str</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.books.<span class="title function_ invoke__">remove</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="返回值与错误处理"><a href="#返回值与错误处理" class="headerlink" title="返回值与错误处理"></a>返回值与错误处理</h1><h2 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h2><p>  -Option返回值：一个变量要么有值：Some(T)，要么为空：None<br>  -Option辅助函数：<br>    - unwrap()：有值的时候返回值，没有值会抛出panic<br>    - unwrap_or(v)：有值返回值，没有值返回默认值v<br>    - is_some()：判断是否有值<br>    - is_none()：判断是否为none</p>
<h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><ul>
<li>可恢复错误：通常用于从系统全局角度来看可以接受的错误，例如处理用户的访问，操作等错误，这些错误只会影响某个用户自身的操作进程，而不会对系统的全局稳定性产生影响。</li>
<li>不可恢复错误：通常是全局性的或者系统性的错误，例如数组越界访问，系统启动时发生了影响启动流程的错误等，这些错误往往对系统时致命的。</li>
</ul>
<h2 id="Result用于可恢复错误"><a href="#Result用于可恢复错误" class="headerlink" title="Result&lt;T,E&gt;用于可恢复错误"></a>Result&lt;T,E&gt;用于可恢复错误</h2><h2 id="panic-用于不可恢复错误"><a href="#panic-用于不可恢复错误" class="headerlink" title="panic! 用于不可恢复错误"></a>panic! 用于不可恢复错误</h2><p><em><strong>RUST_BACKTRACE&#x3D;1 展示调用链更详细信息，从下往上。如果要获取栈回溯新消息，还需要开启debug标志，加上–release 标识debug会被关闭</strong></em><br>  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1. 被动触发</span></span><br><span class="line"><span class="comment">// 缓冲区溢出</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">v</span> = <span class="built_in">vec!</span>[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">  <span class="comment">// panic!</span></span><br><span class="line">  v[<span class="number">99</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2. 主动调用 panice!宏</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="built_in">panic!</span>(<span class="string">&quot;Something went wrong!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>panic时两种终止方式<ul>
<li>栈展开（unwinding）（默认）：Rust会回溯栈上数据和函数调用，因此也意味着更多的善后工作，好处是可以给出充分的报错信息和栈调用信息，便于事后的问题复盘</li>
<li>直接终止（abort）：不清理数据就直接退出程序，善后工作交予操作系统来负责<br><em><strong>对于绝大多数用户，使用默认栈展开时最好的，当你关心最终编译出的二进制可执行文件大小时，那么可以尝试使用直接终止的方式：再Cargo.toml文件中的[profile.release]设置： panic &#x3D; ‘abort’</strong></em></li>
</ul>
</li>
</ul>
<h2 id="用Result处理可恢复的错误"><a href="#用Result处理可恢复的错误" class="headerlink" title="用Result处理可恢复的错误"></a>用Result处理可恢复的错误</h2><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">MathError</span>&#123;</span><br><span class="line">  DivisionByZero,</span><br><span class="line">  NegativeSqurateRoot,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="comment">// 返回err</span></span><br><span class="line">  <span class="keyword">let</span> <span class="variable">res</span> = <span class="title function_ invoke__">divide</span>(<span class="number">10</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="comment">// 处理Result返回值 error.kind()</span></span><br><span class="line">  <span class="keyword">let</span> <span class="variable">res</span> = <span class="keyword">match</span> res &#123;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(n) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, n),</span><br><span class="line">    <span class="title function_ invoke__">Err</span>(e) =&gt; error.<span class="title function_ invoke__">kind</span>()&#123;</span><br><span class="line">      MathError::DivisionByZero =&gt; <span class="built_in">panic!</span>(<span class="string">&quot;Cannot divide by zero&quot;</span>),</span><br><span class="line">      MathError::NegativeSqurateRoot =&gt; <span class="built_in">panic!</span>(<span class="string">&quot;Cannot take sqrt of negative number&quot;</span>),</span><br><span class="line">      _ =&gt; <span class="built_in">panic!</span>(<span class="string">&quot;Unknown error&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">divide</span>(a: <span class="type">i32</span>, b: <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">f64</span>, MathError&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> b == <span class="number">0</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">Err</span>(MathError::DivisionByZero)</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(a <span class="keyword">as</span> <span class="type">f64</span> / b <span class="keyword">as</span> <span class="type">f64</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Result常见函数<ul>
<li>unwrap() 返回Ok的值，如果为Err则panic</li>
<li>unwrap_or(default) 返回Ok的值，如果为Err则返回default</li>
<li>expect(msg) 返回Ok的值，如果为Err则panic，并打印msg</li>
<li>map(f) 将Ok的值应用到f上，返回Result&lt;f(a), E&gt;</li>
<li>map_err(f) 将Err的值应用到f上，返回Result&lt;T, f(e)&gt;<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">x</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;(), <span class="type">String</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">f</span>  = File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;file.txt&quot;</span>).<span class="title function_ invoke__">map_err</span>(|e: std::io::Error| <span class="built_in">format!</span>(<span class="string">&quot;&#123;e&#125;&quot;</span>));</span><br><span class="line">  <span class="keyword">match</span> f &#123;</span><br><span class="line">    <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="title function_ invoke__">Err</span>(e),</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(_) =&gt; <span class="title function_ invoke__">Ok</span>(()),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>传播错误<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="title function_ invoke__">read_username_from_file</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">read_username_from_file</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, std::io::Error&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">f</span> = File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;hello.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">f</span> = <span class="keyword">match</span> f &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(file) =&gt; file,</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="keyword">return</span> <span class="title function_ invoke__">Err</span>(e),</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">match</span> f.<span class="title function_ invoke__">read_to_string</span>(&amp;<span class="keyword">mut</span> s) &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(_) =&gt; <span class="title function_ invoke__">Ok</span>(s),</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="title function_ invoke__">Err</span>(e),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<em><strong>传播错误的简写： ? 运算符</strong></em><ul>
<li>对于Result<ul>
<li>如果结果是Ok(T)，则把T赋值给f</li>
<li>如果结果是Err(E)，则返回该错误</li>
</ul>
</li>
<li>对于Option<ul>
<li>如果值是Some，Some中的值最为表达式的返回值同时函数继续</li>
<li>如果值是None，此时的None会从函数中提前返回<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">fn</span> <span class="title function_">read_username_from_file</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, std::io::Error&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">f</span> = File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;hello.txt&quot;</span>)?;</span><br><span class="line">  f.<span class="title function_ invoke__">read_to_string</span>(&amp;<span class="keyword">mut</span> s)?;</span><br><span class="line">  <span class="title function_ invoke__">Ok</span>(s)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 还可以通过链式调用进一步简写</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">read_username_from_file</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, <span class="type">String</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">  File::<span class="title function_ invoke__">open</span>(<span class="string">&quot;hello.txt&quot;</span>)</span><br><span class="line">      .<span class="title function_ invoke__">map_err</span>(|e| <span class="built_in">format!</span>(<span class="string">&quot;&#123;e&#125;&quot;</span>))?</span><br><span class="line">      .<span class="title function_ invoke__">read_to_string</span>(&amp;<span class="keyword">mut</span> s)</span><br><span class="line">      .<span class="title function_ invoke__">map_err</span>(|e| <span class="built_in">format!</span>(<span class="string">&quot;&#123;e&#125;&quot;</span>))?;</span><br><span class="line">  <span class="title function_ invoke__">Ok</span>(s)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
<li>Result与Option转换<ul>
<li>Option -&gt; Result: ok_or() 函数。 Some(v) to Ok(v),None to Err(err)</li>
<li>Result -&gt; Option: err()和ok()函数。 Err(e) to Some(e) Ok(v) to None</li>
</ul>
</li>
</ul>
<h2 id="课后习题"><a href="#课后习题" class="headerlink" title="课后习题"></a>课后习题</h2><p> &#x2F;&#x2F; 修复call函数的错误<br> &#x2F;&#x2F; 当b为None时，按默认值为1<br> <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">call</span>(a: <span class="type">i32</span>, b: <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">f64</span>,<span class="type">String</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">r</span> = <span class="title function_ invoke__">divide</span>(a,b);</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">s</span> = <span class="title function_ invoke__">sqrt</span>(r);</span><br><span class="line">  <span class="title function_ invoke__">Ok</span>(s)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">divide</span>(a: <span class="type">i32</span>, b: <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">Option</span>&lt;<span class="type">f64</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> b != <span class="number">0</span>&#123;</span><br><span class="line">      <span class="title function_ invoke__">Some</span>(a <span class="keyword">as</span> <span class="type">f64</span> / b <span class="keyword">as</span> <span class="type">f64</span>)</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="literal">None</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">enum</span> <span class="title class_">MathError</span> &#123;</span><br><span class="line">  DivisionByZero,</span><br><span class="line">  NegativeSquareRoot,</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">sqrt</span>(x: <span class="type">f64</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">f64</span>,MathError&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> x &lt; <span class="number">0.0</span> &#123;</span><br><span class="line">      <span class="title function_ invoke__">Err</span>(MathError::NegativeSquareRoot)</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_ invoke__">Ok</span>(x.<span class="title function_ invoke__">sqrt</span>())</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br> <em><strong>解答</strong></em><br> <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">call</span>(a: <span class="type">i32</span>, b: <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">f64</span>,<span class="type">String</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">r</span> = <span class="keyword">match</span> <span class="title function_ invoke__">Some</span>(b) &#123;</span><br><span class="line">      <span class="literal">None</span> =&gt; a <span class="keyword">as</span> <span class="type">f64</span>,</span><br><span class="line">      <span class="title function_ invoke__">Some</span>(v) =&gt; &#123;</span><br><span class="line">          <span class="keyword">let</span> <span class="variable">res</span> = <span class="title function_ invoke__">divide</span>(a,v);</span><br><span class="line">          res.<span class="title function_ invoke__">unwrap_or</span>(<span class="number">0.0</span>)</span><br><span class="line">      &#125;  </span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">s</span> = <span class="title function_ invoke__">sqrt</span>(r)</span><br><span class="line">      .<span class="title function_ invoke__">map_err</span>(|e| <span class="built_in">format!</span>(<span class="string">&quot;e&quot;</span>))?;</span><br><span class="line">  <span class="title function_ invoke__">Ok</span>(s)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</li>
</ul>
<h1 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h1><h2 id="package-项目-一个完整的项目，包含多个crate"><a href="#package-项目-一个完整的项目，包含多个crate" class="headerlink" title="package 项目 一个完整的项目，包含多个crate"></a>package 项目 一个完整的项目，包含多个crate</h2><ul>
<li>二进制Package cargo new project : 生成的main.rs是二进制包的根文件，包名和所属的package名相同</li>
<li>库package cargo new project –lib: 生成的lib.rs是库的根文件，只能被第三方库调用，cargo run不能运行。</li>
</ul>
<h2 id="crate-一个独立的可执行单元，编译后会生成一个可执行文件或者库"><a href="#crate-一个独立的可执行单元，编译后会生成一个可执行文件或者库" class="headerlink" title="crate 一个独立的可执行单元，编译后会生成一个可执行文件或者库"></a>crate 一个独立的可执行单元，编译后会生成一个可执行文件或者库</h2><h2 id="modules-模块。"><a href="#modules-模块。" class="headerlink" title="modules 模块。"></a>modules 模块。</h2> <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mod</span> a &#123;</span><br><span class="line">    <span class="keyword">const</span> NUM: <span class="type">i32</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">echo</span>() &#123;</span><br><span class="line">  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">log</span>() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//module可以嵌套。 内部模块想要被外界访问必须定义为pub</span></span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">mod</span> b &#123;</span><br><span class="line">      <span class="comment">// 内部模块可以直接调用外部模块方法和变量</span></span><br><span class="line">      <span class="keyword">use</span> super::echo;</span><br><span class="line">      <span class="keyword">fn</span> <span class="title function_">echo_b</span>() &#123;</span><br><span class="line">          <span class="title function_ invoke__">echo</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">log</span>() &#123;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// 模块调用</span></span><br><span class="line">   <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="comment">// 用::调用，在同一模块时被调用必须定义为pub，因为访问权限默认为私有</span></span><br><span class="line">    a::<span class="title function_ invoke__">echo</span>();</span><br><span class="line">    <span class="comment">// 访问b模块 </span></span><br><span class="line">    a::b::<span class="title function_ invoke__">log</span>();</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// 给模块成员添加别名，快速访问</span></span><br><span class="line">   <span class="keyword">use</span> a::&#123;b::log <span class="keyword">as</span> log2,log&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>模块可见性<ul>
<li>private 私有(默认) ，只能在当前模块中访问</li>
<li>pub(crate) 同一个crate下可见，其他crate不可见</li>
<li>pub(in xxx) 同一个crate下可见，其他crate不可见，但必须包含在xxx中</li>
<li>pub use 暴露模块成员，让外部模块可以访问</li>
</ul>
</li>
</ul>
<h2 id="workspace-包含多个package"><a href="#workspace-包含多个package" class="headerlink" title="workspace : 包含多个package"></a>workspace : 包含多个package</h2><p>[workspace]<br>members &#x3D; [“course-1”, “course-2”]</p>
<h2 id="Solana"><a href="#Solana" class="headerlink" title="Solana"></a>Solana</h2><h3 id="一、Anchor"><a href="#一、Anchor" class="headerlink" title="一、Anchor"></a>一、Anchor</h3><ol>
<li>创建Anchor项目<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anchor init my_project</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li>项目结构<ul>
<li>Anchor.toml 项目配置文件<ul>
<li>本地的合约地址 program.localnet</li>
<li>合约仓库 registry</li>
<li>solana网络</li>
<li>脚本 scripts。脚本可以是用anchor run <script_name> 执行，默认是test脚本</li>
</ul>
</li>
<li>programs 存放合约源码</li>
<li>app 默认为空，存放前端代码</li>
<li>tests 存放测试程序</li>
<li>migrations 存放部署脚本</li>
</ul>
</li>
</ul>
<ol start="2">
<li>编译、部署合约<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### 编译</span></span><br><span class="line">anchor build</span><br><span class="line"><span class="comment">### 本地部署之前需要运行solana本地网络，并且给本地账户空投sol</span></span><br><span class="line">solana-test-validator</span><br><span class="line"><span class="comment">### 部署 </span></span><br><span class="line">anchor deploy</span><br><span class="line"><span class="comment">### 部署失败 account data too small for instruction</span></span><br><span class="line">solana program extend &lt;PROGRAM_ID&gt; &lt;MORE_BYTES&gt;</span><br></pre></td></tr></table></figure></li>
<li>测试合约<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anchor <span class="built_in">test</span></span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/09/03/Rust/" data-id="cm0m4su2i00009oa23uu7e3ro" data-title="Rust基础" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-practice" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/09/03/practice/" class="article-date">
  <time class="dt-published" datetime="2024-09-02T16:00:00.000Z" itemprop="datePublished">2024-09-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/09/03/practice/">rust练习题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h1><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修复下面代码的错误并尽可能少的修改</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span>: <span class="type">i32</span>; <span class="comment">// 未初始化，但被使用</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">y</span>: <span class="type">i32</span>; <span class="comment">// 未初始化，也未被使用</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;x is equal to &#123;&#125;&quot;</span>, x); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span>: <span class="type">i32</span>; <span class="comment">// 未初始化，但被使用</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">y</span>: <span class="type">i32</span>; <span class="comment">// 未初始化，也未被使用</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;x is equal to &#123;&#125;&quot;</span>, x); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 完形填空，让代码编译</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">__</span> = <span class="number">1</span>;</span><br><span class="line">    __ += <span class="number">2</span>; </span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;x = &#123;&#125;&quot;</span>, x); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">x</span> = <span class="number">1</span>;</span><br><span class="line">    x += <span class="number">2</span>; </span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;x = &#123;&#125;&quot;</span>, x); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修复下面代码的错误并使用尽可能少的改变</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span>: <span class="type">i32</span> = <span class="number">10</span>;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">y</span>: <span class="type">i32</span> = <span class="number">5</span>;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;x 的值是 &#123;&#125;, y 的值是 &#123;&#125;&quot;</span>, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;x 的值是 &#123;&#125;, y 的值是 &#123;&#125;&quot;</span>, x, y); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修复下面代码的错误并使用尽可能少的改变</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span>: <span class="type">i32</span> = <span class="number">10</span>;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">y</span>: <span class="type">i32</span> = <span class="number">5</span>;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;x 的值是 &#123;&#125;, y 的值是 &#123;&#125;&quot;</span>, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;x 的值是 &#123;&#125;&quot;</span>, x); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修复错误</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;, world&quot;</span>, x); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">define_x</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span> = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修复错误</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="title function_ invoke__">define_x</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">define_x</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span> = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;, world&quot;</span>, x); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="5">
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 只允许修改 `assert_eq!` 来让 `println!` 工作(在终端输出 `42`)</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span>: <span class="type">i32</span> = <span class="number">5</span>;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">12</span>;</span><br><span class="line">        <span class="built_in">assert_eq!</span>(x, <span class="number">5</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">assert_eq!</span>(x, <span class="number">12</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">42</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, x); <span class="comment">// 输出 &quot;42&quot;.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 只允许修改 `assert_eq!` 来让 `println!` 工作(在终端输出 `42`)</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span>: <span class="type">i32</span> = <span class="number">5</span>;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">12</span>;</span><br><span class="line">        <span class="built_in">assert_eq!</span>(x, <span class="number">12</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">assert_eq!</span>(x, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">42</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, x); <span class="comment">// 输出 &quot;42&quot;.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="6">
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">x</span>: <span class="type">i32</span> = <span class="number">1</span>;</span><br><span class="line">    x = <span class="number">7</span>;</span><br><span class="line">    <span class="comment">// 遮蔽且再次绑定</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span> = x; </span><br><span class="line">    x += <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">y</span> = <span class="number">4</span>;</span><br><span class="line">    <span class="comment">// 遮蔽</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">y</span> = <span class="string">&quot;I can also be bound to text!&quot;</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">x</span>: <span class="type">i32</span> = <span class="number">1</span>;</span><br><span class="line">    x = <span class="number">7</span>;</span><br><span class="line">    <span class="comment">// 遮蔽且再次绑定</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span> = x; </span><br><span class="line">    x += <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">y</span> = <span class="number">4</span>;</span><br><span class="line">    <span class="comment">// 遮蔽</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">y</span> = <span class="string">&quot;I can also be bound to text!&quot;</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="7">
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">1</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// compiler warning: unused variable: `x`</span></span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">_x</span> = <span class="number">1</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">1</span>; </span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修复下面代码的错误并尽可能少的修改</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> (x, y) = (<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    x += <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">assert_eq!</span>(x, <span class="number">3</span>);</span><br><span class="line">    <span class="built_in">assert_eq!</span>(y, <span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 修复下面代码的错误并尽可能少的修改</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> (<span class="keyword">mut</span> x, y) = (<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    x += <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">assert_eq!</span>(x, <span class="number">3</span>);</span><br><span class="line">    <span class="built_in">assert_eq!</span>(y, <span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> (x, y);</span><br><span class="line">    (x,..) = (<span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">    [.., y] = [<span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line">    <span class="comment">// 填空，让代码工作</span></span><br><span class="line">    <span class="built_in">assert_eq!</span>([x,y], __);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> (x, y);</span><br><span class="line">    (x,..) = (<span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">    [.., y] = [<span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line">    <span class="comment">// 填空，让代码工作</span></span><br><span class="line">    <span class="built_in">assert_eq!</span>([x,y], [<span class="number">3</span>,<span class="number">2</span>]);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="基本类型"><a href="#基本类型" class="headerlink" title="基本类型"></a>基本类型</h1><h2 id="数值类型"><a href="#数值类型" class="headerlink" title="数值类型"></a>数值类型</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 移除某个部分让代码工作</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span>: <span class="type">i32</span> = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">y</span>: <span class="type">u32</span> = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">    y = x;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> <span class="variable">z</span> = <span class="number">10</span>; <span class="comment">// 这里 z 的类型是? </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 移除某个部分让代码工作</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span>: <span class="type">i32</span> = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">y</span>: <span class="type">i32</span> = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">    y = x;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> <span class="variable">z</span> = <span class="number">10</span>; <span class="comment">// 这里 z 的类型是? i32</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 填空</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">v</span>: <span class="type">u16</span> = <span class="number">38_u8</span> <span class="keyword">as</span> __;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 填空</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">v</span>: <span class="type">u16</span> = <span class="number">38_u8</span> <span class="keyword">as</span> <span class="type">u16</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">5</span>;</span><br><span class="line">    <span class="built_in">assert_eq!</span>(<span class="string">&quot;u32&quot;</span>.<span class="title function_ invoke__">to_string</span>(), <span class="title function_ invoke__">type_of</span>(&amp;x));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以下函数可以获取传入参数的类型，并返回类型的字符串形式，例如  &quot;i8&quot;, &quot;u8&quot;, &quot;i32&quot;, &quot;u32&quot;</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">type_of</span>&lt;T&gt;(_: &amp;T) <span class="punctuation">-&gt;</span> <span class="type">String</span> &#123;</span><br><span class="line">    <span class="built_in">format!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, std::any::type_name::&lt;T&gt;())</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">5</span>;</span><br><span class="line">    <span class="built_in">assert_eq!</span>(<span class="string">&quot;i32&quot;</span>.<span class="title function_ invoke__">to_string</span>(), <span class="title function_ invoke__">type_of</span>(&amp;x));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以下函数可以获取传入参数的类型，并返回类型的字符串形式，例如  &quot;i8&quot;, &quot;u8&quot;, &quot;i32&quot;, &quot;u32&quot;</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">type_of</span>&lt;T&gt;(_: &amp;T) <span class="punctuation">-&gt;</span> <span class="type">String</span> &#123;</span><br><span class="line">    <span class="built_in">format!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, std::any::type_name::&lt;T&gt;())</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 填空，让代码工作</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="built_in">assert_eq!</span>(<span class="type">i8</span>::MAX, __); </span><br><span class="line">    <span class="built_in">assert_eq!</span>(<span class="type">u8</span>::MAX, __); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 填空，让代码工作</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="built_in">assert_eq!</span>(<span class="type">i8</span>::MAX, <span class="number">127</span>); </span><br><span class="line">    <span class="built_in">assert_eq!</span>(<span class="type">u8</span>::MAX, <span class="number">255</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 解决代码中的错误和 `panic`</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">   <span class="keyword">let</span> <span class="variable">v1</span> = <span class="number">251_u8</span> + <span class="number">8</span>;</span><br><span class="line">   <span class="keyword">let</span> <span class="variable">v2</span> = <span class="type">i8</span>::<span class="title function_ invoke__">checked_add</span>(<span class="number">251</span>, <span class="number">8</span>).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">   <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;,&#123;&#125;&quot;</span>,v1,v2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="comment">// u8最大值是127 超出会类型溢出</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">v1</span> = <span class="number">241_u8</span> + <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">v2</span> = <span class="type">i8</span>::<span class="title function_ invoke__">checked_add</span>(<span class="number">41</span>, <span class="number">8</span>).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">    <span class="comment">// let v2 = v1.checked_add(8).unwrap();</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;,&#123;&#125;&quot;</span>,v1,v2);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="字符、布尔、单元类型"><a href="#字符、布尔、单元类型" class="headerlink" title="字符、布尔、单元类型"></a>字符、布尔、单元类型</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="语句和表达式"><a href="#语句和表达式" class="headerlink" title="语句和表达式"></a>语句和表达式</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="所有权和借用"><a href="#所有权和借用" class="headerlink" title="所有权和借用"></a>所有权和借用</h1><h2 id="所有权"><a href="#所有权" class="headerlink" title="所有权"></a>所有权</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="引用和借用"><a href="#引用和借用" class="headerlink" title="引用和借用"></a>引用和借用</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="函数-1"><a href="#函数-1" class="headerlink" title="函数"></a>函数</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="所有权和借用-1"><a href="#所有权和借用-1" class="headerlink" title="所有权和借用"></a>所有权和借用</h1><h2 id="所有权-1"><a href="#所有权-1" class="headerlink" title="所有权"></a>所有权</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="复合类型"><a href="#复合类型" class="headerlink" title="复合类型"></a>复合类型</h1><h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="元组"><a href="#元组" class="headerlink" title="元组"></a>元组</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h1><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="模式匹配"><a href="#模式匹配" class="headerlink" title="模式匹配"></a>模式匹配</h1><h2 id="match、matches-和-if-let"><a href="#match、matches-和-if-let" class="headerlink" title="match、matches! 和 if let"></a>match、matches! 和 if let</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="模式"><a href="#模式" class="headerlink" title="模式"></a>模式</h2><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="方法和关联函数"><a href="#方法和关联函数" class="headerlink" title="方法和关联函数"></a>方法和关联函数</h1><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="泛型和特征"><a href="#泛型和特征" class="headerlink" title="泛型和特征"></a>泛型和特征</h1><ol>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure></li>
<li><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">## 泛型</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">## Const泛型</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">## 特征 Traits</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">5</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">6</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">7</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">8</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">9</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">## 特征对象</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">5</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">## 进一步深入特征</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">5</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"># 集合类型</span><br><span class="line">## 动态字符串<span class="type">String</span></span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">5</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">6</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">7</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">## 动态数组Vector</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">5</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">6</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">7</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">8</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">## KV存储HashMap</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">5</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"># 类型转换</span><br><span class="line">## <span class="keyword">as</span></span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">5</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">## <span class="built_in">From</span>、<span class="built_in">Into</span></span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">5</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">## 其他转换</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"># 返回值和<span class="built_in">panic!</span></span><br><span class="line">## <span class="built_in">panic!</span>深入剖析</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">## 返回值result和?</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">5</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">6</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"># 包和模块</span><br><span class="line">## 包Crate</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">5</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">6</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">## 模块Module</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">5</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">## 使用<span class="keyword">use</span>引入模块及受限可见性</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"># 十五、注释和文档</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"># 格式化输出</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">5</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">6</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">7</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">8</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">9</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"># 生命周期</span><br><span class="line"></span><br><span class="line">## 生命周期基础</span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">5</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">6</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">7</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">8</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">9</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">10</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">## &amp;<span class="symbol">&#x27;static</span> and T: <span class="symbol">&#x27;static</span></span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">5</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">6</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">## 深入生命周期</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">2</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">3</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">4</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">5</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"><span class="number">6</span>.</span><br><span class="line">```rust</span><br></pre></td></tr></table></figure>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="函数式编程：闭包、迭代器todo"><a href="#函数式编程：闭包、迭代器todo" class="headerlink" title="函数式编程：闭包、迭代器todo"></a>函数式编程：闭包、迭代器todo</h1><h2 id="闭包Closure"><a href="#闭包Closure" class="headerlink" title="闭包Closure"></a>闭包Closure</h2><h2 id="迭代器Iterator"><a href="#迭代器Iterator" class="headerlink" title="迭代器Iterator"></a>迭代器Iterator</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/09/03/practice/" data-id="cm0m4su2o00019oa2eo7yeb7e" data-title="rust练习题" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/10/">October 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/09/">September 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/10/14/Rust_Advanced/">(no title)</a>
          </li>
        
          <li>
            <a href="/2024/09/03/Rust/">Rust基础</a>
          </li>
        
          <li>
            <a href="/2024/09/03/practice/">rust练习题</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 Hayreal<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>